import{r as e,a as s,R as t}from"./vendor-BXk_ma1u.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)}).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();var a={exports:{}},r={},l=e,i=Symbol.for("react.element"),d=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,c=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function m(e,s,t){var a,r={},l=null,d=null;for(a in void 0!==t&&(l=""+t),void 0!==s.key&&(l=""+s.key),void 0!==s.ref&&(d=s.ref),s)n.call(s,a)&&!o.hasOwnProperty(a)&&(r[a]=s[a]);if(e&&e.defaultProps)for(a in s=e.defaultProps)void 0===r[a]&&(r[a]=s[a]);return{$$typeof:i,type:e,key:l,ref:d,props:r,_owner:c.current}}r.Fragment=d,r.jsx=m,r.jsxs=m,a.exports=r;var x=a.exports,u={},g=s;u.createRoot=g.createRoot,u.hydrateRoot=g.hydrateRoot;class h extends t.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){console.error("React Error:",e,s)}render(){var e;return this.state.hasError?x.jsx("div",{className:"min-h-screen bg-red-50 flex items-center justify-center",children:x.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-md",children:[x.jsx("h2",{className:"text-xl font-bold text-red-800 mb-4",children:"Something went wrong"}),x.jsx("p",{className:"text-gray-600 mb-4",children:"There was an error loading the application."}),x.jsx("pre",{className:"bg-gray-100 p-4 rounded text-xs overflow-auto",children:null==(e=this.state.error)?void 0:e.toString()}),x.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Reload Page"})]})}):this.props.children}}const p=[{name:"Planning",icon:"üß†",stage:"Research Planning",description:"Analyze query & create plan",agent:"Planner Agent"},{name:"Gathering",icon:"üîç",stage:"Information Gathering",description:"Search & collect data",agent:"Search Agent"},{name:"Quality Check",icon:"‚úÖ",stage:"Quality Evaluation",description:"Evaluate quality & relevance",agent:"Quality Agent"},{name:"Analysis",icon:"üìä",stage:"Content Summarization",description:"Summarize & analyze",agent:"Analysis Agent"},{name:"Synthesis",icon:"üìù",stage:"Report Assembly",description:"Generate & format report",agent:"Report Agent"}],b=[{name:"Research Planner",icon:"üß†"},{name:"Web Retriever",icon:"üîç"},{name:"Quality Evaluator",icon:"‚öñÔ∏è"},{name:"Summarizer",icon:"üìä"},{name:"Report Synthesizer",icon:"üìù"}],f=[{name:"FastAPI",icon:"üöÄ"},{name:"SQLite DB",icon:"üíæ"},{name:"Redis Cache",icon:"‚ö°"},{name:"Fireworks AI",icon:"ü§ñ"},{name:"Web APIs",icon:"üåê"}],j=e.memo(({progress:e})=>x.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 mb-6",children:p.map((s,t)=>{var a;const r=e&&e.stage===s.stage,l=e&&e.stage_breakdown&&"completed"===(null==(a=e.stage_breakdown.find(e=>e.name===s.stage))?void 0:a.status);return x.jsxs("div",{className:"relative",children:[x.jsx("div",{className:"p-4 rounded-lg border-2 transition-all duration-300 "+(r?"border-blue-500 bg-blue-100 shadow-md transform scale-105":l?"border-green-500 bg-green-50":"border-gray-300 bg-white hover:bg-gray-50"),children:x.jsxs("div",{className:"text-center",children:[x.jsx("div",{className:"text-3xl mb-2 "+(r?"animate-bounce":""),children:s.icon}),x.jsx("div",{className:"font-bold text-sm mb-1 "+(r?"text-blue-700":l?"text-green-700":"text-gray-600"),children:s.name}),x.jsx("div",{className:"text-xs text-gray-500 mb-2 leading-tight",children:s.description}),x.jsx("div",{className:"text-xs text-gray-400 font-mono",children:s.agent}),l&&x.jsx("div",{className:"text-green-600 text-lg mt-2",children:x.jsx("i",{className:"fas fa-check-circle"})}),r&&x.jsx("div",{className:"text-blue-600 text-lg mt-2",children:x.jsx("i",{className:"fas fa-spinner fa-spin"})})]})}),t<4&&x.jsx("div",{className:"hidden md:block absolute top-1/2 -right-2 transform -translate-y-1/2 z-10",children:x.jsx("div",{className:"w-0 h-0 border-l-[8px] border-r-[8px] border-t-[6px] border-l-transparent border-r-transparent "+(l?"border-t-green-500":"border-t-gray-300")})})]},s.name)})}));j.displayName="PipelineFlow";const v=e.memo(({show:s,onClose:t,apiKeys:a,setApiKeys:r})=>{const[l,i]=e.useState(()=>localStorage.getItem("preferredSearchEngine")||"firecrawl"),d=e.useCallback(()=>{localStorage.setItem("apiKeys",JSON.stringify(a)),localStorage.setItem("preferredSearchEngine",l),t()},[a,l,t]);return s?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-50 p-2 pt-4 pb-4 overflow-hidden",children:x.jsxs("div",{className:"bg-white rounded-lg w-full max-w-lg max-h-full flex flex-col shadow-2xl min-h-0",children:[x.jsx("div",{className:"p-6 pb-4 border-b border-gray-200 flex-shrink-0",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"API Configuration"}),x.jsx("p",{className:"text-sm text-gray-600",children:"Configure your API keys for research"})]}),x.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:x.jsx("i",{className:"fas fa-times text-lg"})})]})}),x.jsx("div",{className:"flex-1 overflow-y-auto p-6",style:{scrollbarGutter:"stable"},children:x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fireworks AI API Key (Required)"}),x.jsx("input",{type:"password",value:a.fireworks,onChange:e=>r(s=>({...s,fireworks:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your Fireworks AI API key"})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Search Engine"}),x.jsxs("select",{value:l,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[x.jsx("option",{value:"firecrawl",children:"Firecrawl (Preferred - Full Content)"}),x.jsx("option",{value:"brave",children:"Brave Search (Fast Snippets)"}),x.jsx("option",{value:"auto",children:"Auto (Try Firecrawl, fallback to Brave)"})]}),x.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Firecrawl provides full content extraction for better quality evaluation"})]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Firecrawl API Key ","brave"===l?"(Optional)":"(Recommended)"]}),x.jsx("input",{type:"password",value:a.firecrawl,onChange:e=>r(s=>({...s,firecrawl:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your Firecrawl API key"}),x.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Get your key from ",x.jsx("a",{href:"https://firecrawl.dev",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:"firecrawl.dev"})]})]}),x.jsxs("div",{children:[x.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Brave Search API Key ","firecrawl"===l?"(Fallback)":"(Required)"]}),x.jsx("input",{type:"password",value:a.brave,onChange:e=>r(s=>({...s,brave:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your Brave Search API key"}),x.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Get your key from ",x.jsx("a",{href:"https://brave.com/search/api",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:"brave.com/search/api"})]})]})]})}),x.jsx("div",{className:"p-6 pt-4 border-t border-gray-200 flex-shrink-0",children:x.jsxs("div",{className:"flex justify-end space-x-3",children:[x.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel"}),x.jsx("button",{onClick:d,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Save Configuration"})]})})]})}):null});v.displayName="ApiConfigModal";const N=e.memo(({show:e,onClose:s,modelConfig:t,agentModels:a,availableModels:r,updateAgentModel:l,saveModelConfig:i,applyModelPreset:d})=>e?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-50 p-2 pt-4 pb-4 overflow-hidden",children:x.jsxs("div",{className:"bg-white rounded-lg w-full max-w-6xl max-h-full flex flex-col shadow-2xl min-h-0",children:[x.jsx("div",{className:"p-4 pb-3 border-b border-gray-200 flex-shrink-0",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Agent Model Configuration"}),x.jsx("p",{className:"text-xs text-gray-600",children:"Configure AI models for optimal performance"})]}),x.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:x.jsx("i",{className:"fas fa-times text-lg"})})]})}),x.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{scrollbarGutter:"stable"},children:t&&t.agent_assignments?x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[x.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-magic mr-2 text-purple-500"}),"Quick Model Presets"]}),x.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Choose a preset to automatically configure optimal models for each agent based on their specific tasks."}),x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[x.jsxs("button",{onClick:()=>{console.log("üñ±Ô∏è Modal Budget preset clicked"),d&&d("budget")},className:"px-3 py-2 text-sm bg-green-50 border border-green-200 text-green-700 rounded-md hover:bg-green-100 transition-colors flex items-center justify-center",title:"Cost-effective models optimized for each agent task",children:[x.jsx("i",{className:"fas fa-piggy-bank mr-2"}),"Budget"]}),x.jsxs("button",{onClick:()=>{console.log("üñ±Ô∏è Modal Balanced preset clicked"),d&&d("balanced")},className:"px-3 py-2 text-sm bg-blue-50 border border-blue-200 text-blue-700 rounded-md hover:bg-blue-100 transition-colors flex items-center justify-center",title:"Good balance of cost and performance with task specialization",children:[x.jsx("i",{className:"fas fa-balance-scale mr-2"}),"Balanced"]}),x.jsxs("button",{onClick:()=>{console.log("üñ±Ô∏è Modal Performance preset clicked"),d&&d("performance")},className:"px-3 py-2 text-sm bg-purple-50 border border-purple-200 text-purple-700 rounded-md hover:bg-purple-100 transition-colors flex items-center justify-center",title:"High-quality models specialized for each agent's role",children:[x.jsx("i",{className:"fas fa-rocket mr-2"}),"Performance"]}),x.jsxs("button",{onClick:()=>{console.log("üñ±Ô∏è Modal Premium preset clicked"),d&&d("premium")},className:"px-3 py-2 text-sm bg-rose-50 border border-rose-200 text-rose-700 rounded-md hover:bg-rose-100 transition-colors flex items-center justify-center",title:"Best available models for maximum quality results",children:[x.jsx("i",{className:"fas fa-crown mr-2"}),"Premium"]})]})]}),x.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[x.jsxs("h4",{className:"text-sm font-semibold text-blue-800 mb-2 flex items-center",children:[x.jsx("i",{className:"fas fa-info-circle mr-2"}),"Current Configuration"]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-xs",children:[x.jsxs("div",{children:[x.jsx("span",{className:"font-medium text-blue-700",children:"Budget Limit:"}),x.jsxs("div",{className:"text-blue-800",children:["$",t.budget_limit,"/query"]})]}),x.jsxs("div",{children:[x.jsx("span",{className:"font-medium text-blue-700",children:"Total Agents:"}),x.jsx("div",{className:"text-blue-800",children:t.agent_assignments.length})]}),x.jsxs("div",{children:[x.jsx("span",{className:"font-medium text-blue-700",children:"Available Models:"}),x.jsx("div",{className:"text-blue-800",children:t.available_models.length})]})]})]}),x.jsxs("div",{children:[x.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[x.jsx("i",{className:"fas fa-robot mr-2 text-purple-600"}),"Agent Model Assignments"]}),x.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:t.agent_assignments.map((e,s)=>x.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[x.jsxs("div",{className:"flex items-center justify-between mb-3",children:[x.jsxs("div",{children:[x.jsxs("h5",{className:"font-semibold text-gray-900 capitalize",children:[e.agent_type.replace("_"," ")," Agent"]}),x.jsx("p",{className:"text-xs text-gray-600",children:e.description})]}),x.jsxs("div",{className:"text-right text-xs text-gray-500",children:[x.jsxs("div",{children:["Max: ",e.max_tokens," tokens"]}),x.jsxs("div",{children:["Temp: ",e.temperature]})]})]}),x.jsxs("div",{className:"mb-3",children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Model"}),x.jsx("select",{value:a[e.agent_type]||e.model_name,onChange:s=>l(e.agent_type,s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm",children:t.available_models.map(e=>x.jsx("option",{value:e,children:e},e))})]}),(()=>{const s=a[e.agent_type]||e.model_name,r=t.model_pricing[s];return r?x.jsx("div",{className:"bg-white rounded p-2 border border-gray-200",children:x.jsxs("div",{className:"text-xs text-gray-600",children:[x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{children:"Input:"}),x.jsxs("span",{className:"font-mono",children:["$",r.input,"/1M tokens"]})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{children:"Output:"}),x.jsxs("span",{className:"font-mono",children:["$",r.output,"/1M tokens"]})]})]})}):null})()]},e.agent_type))})]})]}):x.jsxs("div",{className:"text-center py-8",children:[x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto mb-4"}),x.jsx("div",{className:"text-gray-600",children:"Loading model configuration..."})]})}),x.jsx("div",{className:"p-4 pt-3 border-t border-gray-200 flex-shrink-0",children:x.jsxs("div",{className:"flex justify-end space-x-3",children:[x.jsx("button",{onClick:s,className:"px-6 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel"}),x.jsxs("button",{onClick:i,className:"px-6 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors flex items-center",children:[x.jsx("i",{className:"fas fa-save mr-2"}),"Save Configuration"]})]})})]})}):null);N.displayName="ModelConfigModal";const y=e.memo(({show:e,onToggle:s,progress:t})=>x.jsx("div",{className:"w-80 transition-all duration-300 ease-in-out "+(e?"opacity-100 translate-x-0":"opacity-0 translate-x-full pointer-events-none"),children:x.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 h-fit",children:[x.jsxs("div",{className:"flex items-center justify-between mb-3",children:[x.jsxs("h2",{className:"text-sm font-semibold text-gray-900",children:[x.jsx("i",{className:"fas fa-network-wired text-blue-500 mr-2"}),"System Architecture"]}),x.jsxs("button",{onClick:s,className:"text-xs text-gray-500 hover:text-gray-700 flex items-center px-2 py-1 rounded hover:bg-gray-100 transition-colors",children:[x.jsx("i",{className:"fas fa-chevron-right mr-1"}),"Hide"]})]}),x.jsxs("div",{className:"mb-4",children:[x.jsxs("h3",{className:"text-xs font-medium text-gray-700 mb-2",children:[x.jsx("i",{className:"fas fa-route text-indigo-500 mr-1"}),"Processing Pipeline"]}),x.jsx("div",{className:"space-y-1",children:p.map((e,s)=>{var a;const r=t&&t.stage===e.stage,l=t&&t.stage_breakdown&&"completed"===(null==(a=t.stage_breakdown.find(s=>s.name===e.stage))?void 0:a.status);return x.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded text-xs "+(r?"bg-blue-50 border border-blue-200":l?"bg-green-50 border border-green-200":"bg-gray-50 border border-gray-100"),children:[x.jsx("span",{className:"text-sm",children:e.icon}),x.jsx("span",{className:"font-medium "+(r?"text-blue-700":l?"text-green-700":"text-gray-600"),children:e.name}),r&&x.jsx("i",{className:"fas fa-spinner fa-spin text-blue-500 ml-auto"}),l&&x.jsx("i",{className:"fas fa-check text-green-500 ml-auto"})]},s)})})]}),x.jsxs("div",{className:"mb-4",children:[x.jsxs("h3",{className:"text-xs font-medium text-gray-700 mb-2",children:[x.jsx("i",{className:"fas fa-users text-purple-500 mr-1"}),"AI Agents"]}),x.jsx("div",{className:"space-y-1",children:b.map((e,s)=>x.jsxs("div",{className:"flex items-center space-x-2 p-1.5 bg-gray-50 rounded text-xs",children:[x.jsx("span",{children:e.icon}),x.jsx("span",{className:"text-gray-700 font-medium",children:e.name})]},s))})]}),x.jsxs("div",{children:[x.jsxs("h3",{className:"text-xs font-medium text-gray-700 mb-2",children:[x.jsx("i",{className:"fas fa-cogs text-blue-500 mr-1"}),"Components"]}),x.jsx("div",{className:"space-y-1",children:f.map((e,s)=>x.jsxs("div",{className:"flex items-center space-x-2 p-1.5 bg-gray-50 rounded text-xs",children:[x.jsx("span",{children:e.icon}),x.jsx("span",{className:"text-gray-700 font-medium",children:e.name})]},s))})]})]})}));y.displayName="ArchitectureSidebar";const _={startResearch:async e=>(await fetch("/api/research/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json(),getResults:async e=>(await fetch(`/api/research/${e}/results`)).json(),getMetrics:async e=>(await fetch(`/api/research/${e}/metrics`)).json(),getModels:async()=>(await fetch("/api/models")).json(),getModelConfig:async()=>(await fetch("/api/models/config")).json(),updateModelConfig:async e=>(await fetch("/api/models/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agent_models:e})})).json()},w=(e,s)=>{const t=`${"https:"===window.location.protocol?"wss:":"ws:"}//${window.location.host}/ws/${e}`;console.log("Connecting to WebSocket:",t);const a=new WebSocket(t);return a.onopen=()=>{var e;console.log("WebSocket connected successfully"),null==(e=s.onOpen)||e.call(s)},a.onmessage=e=>{var t;console.log("WebSocket message received:",e.data);try{const a=JSON.parse(e.data);null==(t=s.onMessage)||t.call(s,a)}catch(a){console.error("Error parsing WebSocket message:",a)}},a.onerror=e=>{var t;console.error("WebSocket error:",e),null==(t=s.onError)||t.call(s,e)},a.onclose=e=>{var t;console.log("WebSocket disconnected:",e.code,e.reason),null==(t=s.onClose)||t.call(s,e)},a},k=()=>{const[s,t]=e.useState("llama-v3p1-8b-instruct"),[a,r]=e.useState([]),[l,i]=e.useState({}),[d,n]=e.useState(null),[c,o]=e.useState(!1),[m,x]=e.useState(null),[u,g]=e.useState(()=>{try{const e=localStorage.getItem("apiKeys");return e?JSON.parse(e):{fireworks:"",brave:"",firecrawl:""}}catch{return{fireworks:"",brave:"",firecrawl:""}}});e.useEffect(()=>{localStorage.setItem("apiKeys",JSON.stringify(u))},[u]);const h=e.useCallback(async()=>{try{const e=await _.getModelConfig();if(e.success){n(e);const s={};e.agent_assignments.forEach(e=>{s[e.agent_type]=e.model_name}),i(s)}}catch(e){console.error("Failed to load model configuration:",e)}},[]),p=e.useCallback((e,s)=>{i(t=>({...t,[e]:s}))},[]),b=e.useCallback(async()=>{try{const e=await _.updateModelConfig(l);e.success?(n(e.updated_config),x(null)):x(e.error)}catch(e){x("Failed to save model configuration: "+e.message)}},[l]),f=e.useCallback(()=>{o(e=>!e)},[]),j=e.useCallback(e=>{if(console.log("üéØ Applying preset:",e),console.log("üìã Current modelConfig:",d),console.log("ü§ñ Current agentModels:",l),!d||!d.agent_assignments)return void console.warn("‚ùå No modelConfig or agent_assignments available");const s=d.available_models||[];console.log("üì¶ Available models:",s),console.log("üìä Total available models:",s.length);const t={budget:{research_planner:["qwen3-8b","qwen2-7b-instruct"],web_search:["llama-v3p1-8b-instruct","qwen2-7b-instruct"],quality_evaluation:["qwen3-8b","qwen2-7b-instruct"],summarization:["qwen2-7b-instruct","llama-v3p1-8b-instruct"],report_synthesis:["qwen3-8b","qwen2-7b-instruct"]},balanced:{research_planner:["qwen3-30b-a3b","llama4-scout-instruct-basic"],web_search:["llama-v3p1-8b-instruct","qwen3-8b"],quality_evaluation:["qwen3-235b-a22b","qwen3-30b-a3b"],summarization:["qwen3-30b-a3b","llama4-scout-instruct-basic"],report_synthesis:["llama4-maverick-instruct-basic","qwen3-235b-a22b"]},performance:{research_planner:["qwq-32b","llama-v3p3-70b-instruct"],web_search:["qwen3-30b-a3b","llama-v3p1-8b-instruct"],quality_evaluation:["llama-v3p3-70b-instruct","qwen2p5-72b-instruct"],summarization:["llama-v3p3-70b-instruct","llama-v3p1-70b-instruct"],report_synthesis:["llama-v3p3-70b-instruct","qwen2p5-72b-instruct"]},premium:{research_planner:["deepseek-r1-basic","llama-v3p1-405b-instruct"],web_search:["qwen3-30b-a3b","llama4-scout-instruct-basic"],quality_evaluation:["deepseek-r1","llama-v3p1-405b-instruct"],summarization:["llama-v3p1-405b-instruct","deepseek-r1-basic"],report_synthesis:["deepseek-r1","llama-v3p1-405b-instruct"]}}[e];if(!t)return void console.warn("‚ùå Unknown preset type:",e);console.log("üé® Using preset configuration:",t);const a={};d.agent_assignments.forEach(e=>{const r=e.agent_type;console.log(`üîç Processing agent: ${r}`);const l=t[r]||t.research_planner;console.log(`üìù Candidate models for ${r}:`,l);const i=l.filter(e=>s.includes(e));console.log(`‚úÖ Available candidates for ${r}:`,i);const d=(e=>{for(const t of e)if(s.includes(t))return t;return s[0]||e[0]})(l);console.log(`üéØ Selected model for ${r}: ${d}`),console.log("üîç Model exists in available list?",s.includes(d)),a[r]=d}),console.log("üöÄ New agent models configuration:",a),console.log("üîÑ About to update agent models state..."),i(a),console.log("‚úÖ Preset applied successfully!"),console.log("üéØ State should update to:",a)},[d,l]);return e.useEffect(()=>{console.log("üîÑ agentModels state changed:",l)},[l]),e.useEffect(()=>{_.getModels().then(e=>{e.models&&(r(e.models),e.default_model&&t(e.default_model))}).catch(e=>{console.error("Failed to fetch models:",e)}),h()},[h]),{selectedModel:s,setSelectedModel:t,availableModels:a,agentModels:l,modelConfig:d,showModelConfig:c,error:m,setError:x,updateAgentModel:p,saveModelConfig:b,toggleModelConfig:f,loadModelConfig:h,applyModelPreset:j,apiKeys:u,setApiKeys:g}},C={status:"idle",currentStage:null,query:"",maxQuestions:5,results:null,metrics:null,currentSession:null,progress:null,progressPercentage:0,currentOperation:null,tokensUsed:0,estimatedCost:0,apiCallsMade:0,duration:null,showArchitecture:!0,showApiConfig:!1,showModelConfig:!1,error:null,isConnected:!1},S="START_RESEARCH",A="RESEARCH_COMPLETED",R="RESEARCH_FAILED",M="UPDATE_PROGRESS",q="SET_QUERY",P="SET_MAX_QUESTIONS",E="SET_RESULTS",F="SET_METRICS",I="SET_SESSION",T="TOGGLE_ARCHITECTURE",D="TOGGLE_API_CONFIG",$="TOGGLE_MODEL_CONFIG",O="SET_ERROR",L="CLEAR_ERROR",Q="WEBSOCKET_CONNECTED",z="WEBSOCKET_DISCONNECTED",U="RESET_RESEARCH",B=(e,s)=>{switch(s.type){case S:return{...e,status:"researching",currentStage:null,error:null,results:null,progressPercentage:0,tokensUsed:0,estimatedCost:0,apiCallsMade:0};case M:const{progress:t}=s,a={...e,progress:t};if(void 0!==t.progress_percentage&&(a.progressPercentage=t.progress_percentage),t.current_operation&&(a.currentOperation=t.current_operation),void 0!==t.tokens_used&&(a.tokensUsed=t.tokens_used),void 0!==t.estimated_cost&&(a.estimatedCost=t.estimated_cost),void 0!==t.api_calls_made&&(a.apiCallsMade=t.api_calls_made),t.stage&&(a.currentStage=t.stage),"completed"===t.status&&(a.status="completed",a.currentStage=null,t.final_metrics&&(a.tokensUsed=t.final_metrics.total_tokens||a.tokensUsed,a.estimatedCost=t.final_metrics.total_cost||a.estimatedCost,a.apiCallsMade=t.final_metrics.total_api_calls||a.apiCallsMade,a.duration=t.final_metrics.total_duration||t.final_metrics.duration||t.final_metrics.elapsed_time),a.duration||(a.duration=t.total_duration||t.elapsed_time||t.duration||t.current_duration||t.research_duration||t.time_elapsed),!a.duration&&s.researchStartTime)){const e=(Date.now()-s.researchStartTime)/1e3;a.duration=`${e.toFixed(1)}s`}return"error"===t.status&&(a.status="failed",a.error=t.message||"Research failed",a.currentStage=null),a;case A:return{...e,status:"completed",results:s.results,stages:e.stages.map(e=>({...e,status:"completed"})),currentStage:null};case R:return{...e,status:"failed",error:s.error,currentStage:null};case q:return{...e,query:s.query};case P:return{...e,maxQuestions:s.maxQuestions};case E:return{...e,results:s.results};case F:return{...e,metrics:s.metrics};case I:return{...e,currentSession:s.sessionId};case T:return{...e,showArchitecture:!e.showArchitecture};case D:return{...e,showApiConfig:!e.showApiConfig};case $:return{...e,showModelConfig:!e.showModelConfig};case O:return{...e,error:s.error};case L:return{...e,error:null};case Q:return{...e,isConnected:!0};case z:return{...e,isConnected:!1};case U:return{...C,query:e.query,maxQuestions:e.maxQuestions,showArchitecture:e.showArchitecture,showApiConfig:e.showApiConfig,showModelConfig:e.showModelConfig};default:return e}},G=e.createContext(),K=({children:s})=>{const[t,a]=e.useReducer(B,C),r=e.useRef(null),l=e.useRef(null),i=e.useCallback(e=>{e.type===M&&(e.researchStartTime=l.current),a(e)},[]),d={setQuery:e.useCallback(e=>{i({type:q,query:e})},[i]),setMaxQuestions:e.useCallback(e=>{i({type:P,maxQuestions:e})},[i]),toggleArchitecture:e.useCallback(()=>{i({type:T})},[i]),toggleApiConfig:e.useCallback(()=>{i({type:D})},[i]),toggleModelConfig:e.useCallback(()=>{i({type:$})},[i]),setError:e.useCallback(e=>{i({type:O,error:e})},[i]),clearError:e.useCallback(()=>{i({type:L})},[i]),setMetrics:e.useCallback(e=>{i({type:F,metrics:e})},[i]),startResearch:e.useCallback(async(e,s)=>{if(!t.query||!t.query.trim())return void i({type:O,error:"‚ö†Ô∏è Please enter a research query"});const a=t.query.trim();if(a.length<3)i({type:O,error:`‚ö†Ô∏è Query must be at least 3 characters long. You entered: '${a}' (${a.length} characters)`});else if(a.length>1e3)i({type:O,error:`‚ö†Ô∏è Query must be no more than 1000 characters long. You entered ${a.length} characters`});else try{const d={query:a,max_questions:t.maxQuestions,selected_model:(null==e?void 0:e.default_model)||"accounts/fireworks/models/llama-v3p1-405b-instruct",agent_models:s,executive_summary_style:"comprehensive",output_format:"json",save_session:!0};i({type:S}),l.current=Date.now();const n=await _.startResearch(d);if(n.session_id){i({type:I,sessionId:n.session_id});window.location.protocol,window.location.host,n.session_id;r.current&&r.current.close(),r.current=w(n.session_id,{onMessage:e=>{i({type:M,progress:e}),"completed"===e.status&&(_.getResults(n.session_id).then(e=>{i({type:E,results:e})}).catch(console.error),_.getMetrics(n.session_id).then(e=>{e.success&&e.metrics&&i({type:F,metrics:e.metrics})}).catch(console.error))},onOpen:()=>{i({type:Q})},onClose:()=>{i({type:z})},onError:e=>{i({type:z}),i({type:O,error:"WebSocket connection failed"})}})}else i({type:R,error:n.message})}catch(d){i({type:R,error:d.message||"Failed to start research"})}},[t.query,t.maxQuestions,i]),resetResearch:e.useCallback(()=>{r.current&&r.current.close(),l.current=null,i({type:U})},[i])},n=e.useCallback(()=>{if(!l.current)return null;if("completed"===t.status&&t.duration)return"string"==typeof t.duration?t.duration:`${t.duration.toFixed(1)}s`;if("researching"===t.status){return`${((Date.now()-l.current)/1e3).toFixed(1)}s`}return null},[t.status,t.duration]),c={state:t,actions:d,getRealTimeDuration:n,isResearching:"researching"===t.status,isCompleted:"completed"===t.status,isFailed:"failed"===t.status};return x.jsx(G.Provider,{value:c,children:s})},W=({source:s,index:t})=>{const[a,r]=e.useState(!1);return x.jsxs("div",{className:"bg-white rounded-lg border border-emerald-100 shadow-sm",children:[x.jsxs("div",{className:"flex items-start justify-between p-3 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>r(!a),children:[x.jsxs("div",{className:"flex-1 min-w-0",children:[x.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[x.jsx("div",{className:"flex items-center justify-center w-6 h-6 bg-emerald-100 text-emerald-600 rounded-full text-xs font-bold",children:t+1}),x.jsx("div",{className:"text-sm font-medium text-gray-800 truncate",children:s.title||(e=>{try{return new URL(e).hostname.replace("www.","")}catch{return e}})(s.url)})]}),x.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-1",children:[x.jsx("i",{className:"fas fa-link text-emerald-500"}),x.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 hover:underline truncate max-w-md",onClick:e=>e.stopPropagation(),children:s.url}),s.relevance_score&&x.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(s.relevance_score>=.8?"bg-green-100 text-green-700":s.relevance_score>=.6?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"),children:[Math.round(100*s.relevance_score),"% relevant"]})]}),(s.content||s.snippet||s.description)&&x.jsxs("div",{className:"mt-2 text-xs text-gray-700 leading-relaxed bg-gradient-to-r from-blue-50 to-indigo-50 px-3 py-2 rounded-md border border-blue-100 italic",children:['"',((e,s=150)=>{if(!e)return"";let t=e.replace(/!\[.*?\]\(.*?\)/g,"").replace(/\[([^\]]+)\]\([^)]+\)/g,"$1").replace(/<[^>]*>/g,"").replace(/\d{4}-\d{2}-\d{2}\d{2}\s+\w+\s+\d{4}/g,"").replace(/Last updated:\s*/gi,"").replace(/^#+\s*/gm,"").replace(/\s+/g," ").trim();const a=t.split(/[.!?]+/).filter(e=>e.trim().length>20);return a.length>0&&(t=a[0].trim()+(a.length>1?"...":".")),t.length>s?t.substring(0,s)+"...":t})(s.content||s.snippet||s.description,180),'"']})]}),x.jsx("div",{className:"flex-shrink-0 ml-2",children:x.jsx("i",{className:`fas fa-chevron-${a?"up":"down"} text-xs text-gray-400 transition-transform`})})]}),a&&x.jsx("div",{className:"border-t bg-gray-50 p-3",children:x.jsxs("div",{className:"space-y-3",children:[(s.content||s.snippet||s.description)&&x.jsxs("div",{children:[x.jsxs("div",{className:"text-xs font-medium text-gray-700 mb-1",children:["Full Content ",s.source_type&&`(${"firecrawl"===s.source_type?"Firecrawl":"Brave Search"})`,":"]}),x.jsx("div",{className:"text-xs text-gray-700 bg-white rounded p-3 border border-gray-200 max-h-64 overflow-y-auto scrollbar-thin",children:x.jsx("div",{className:"whitespace-pre-wrap leading-relaxed",children:s.content||s.snippet||s.description})}),x.jsx("div",{className:"flex justify-end mt-2",children:x.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(s.content||s.snippet||s.description)},className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[x.jsx("i",{className:"fas fa-copy"}),"Copy ","firecrawl"===s.source_type?"Full Page Content":"Content"]})})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.type&&x.jsxs("div",{children:[x.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"Content Type:"}),x.jsx("div",{className:"text-xs text-gray-600 bg-white rounded px-2 py-1 border border-gray-200",children:s.type})]}),s.date&&x.jsxs("div",{children:[x.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"Published:"}),x.jsx("div",{className:"text-xs text-gray-600 bg-white rounded px-2 py-1 border border-gray-200",children:s.date})]})]}),s.key_points&&s.key_points.length>0&&x.jsxs("div",{children:[x.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"Key Points:"}),x.jsx("div",{className:"space-y-1",children:s.key_points.map((e,s)=>x.jsxs("div",{className:"text-xs text-gray-700 bg-white rounded p-2 border border-gray-200 flex items-start",children:[x.jsx("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full mr-2 mt-1.5 flex-shrink-0"}),x.jsx("div",{children:e})]},s))})]}),(s.content||s.snippet||s.description)&&x.jsx("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-200",children:x.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(s.content||s.snippet||s.description)},className:"text-xs text-gray-600 hover:text-gray-800 flex items-center gap-1",children:[x.jsx("i",{className:"fas fa-copy"}),x.jsxs("span",{children:["Copy ","firecrawl"===s.source_type?"Full Page Content":"Content"]})]})})]})})]})},H=({evaluation:s,index:t})=>{const[a,r]=e.useState(!1),l=e=>(100*e).toFixed(0)+"%";return x.jsxs("div",{className:"bg-white rounded-lg border border-amber-100 shadow-sm",children:[x.jsxs("div",{className:"flex items-start justify-between p-3 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>r(!a),children:[x.jsxs("div",{className:"flex-1 min-w-0",children:[x.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[x.jsx("div",{className:"flex items-center justify-center w-6 h-6 bg-amber-100 text-amber-600 rounded-full text-xs font-bold",children:t+1}),x.jsx("div",{className:"text-sm font-medium text-gray-800 truncate",children:s.sub_question})]}),x.jsxs("div",{className:"flex items-center gap-2 text-xs mb-2",children:[x.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-bold "+(i=s.pass_fail_status,"PASS"===i?"text-green-700 bg-green-100":"text-red-700 bg-red-100"),children:s.pass_fail_status}),x.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${(e=>{switch(e){case"A+":case"A":return"text-green-700 bg-green-100";case"B+":case"B":return"text-blue-700 bg-blue-100";case"C+":case"C":return"text-yellow-700 bg-yellow-100";case"D":return"text-orange-700 bg-orange-100";case"F":return"text-red-700 bg-red-100";default:return"text-gray-700 bg-gray-100"}})(s.quality_grade)}`,children:["Grade: ",s.quality_grade]}),x.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-700",children:[l(s.overall_confidence)," confidence"]})]}),x.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[x.jsxs("span",{children:[x.jsx("i",{className:"fas fa-link mr-1"}),s.sources_evaluated," sources"]}),x.jsxs("span",{children:[x.jsx("i",{className:"fas fa-lightbulb mr-1"}),s.insights_found," insights"]}),x.jsxs("span",{children:[x.jsx("i",{className:"fas fa-check mr-1"}),s.facts_extracted," facts"]})]})]}),x.jsx("div",{className:"flex-shrink-0 ml-2",children:x.jsx("i",{className:`fas fa-chevron-${a?"up":"down"} text-xs text-gray-400 transition-transform`})})]}),a&&x.jsx("div",{className:"border-t bg-gray-50 p-3",children:x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Quality Score Breakdown:"}),x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[x.jsxs("div",{className:"bg-white rounded p-2 border",children:[x.jsx("div",{className:"text-xs text-gray-600",children:"Relevance"}),x.jsx("div",{className:"text-sm font-bold text-gray-800",children:l(s.relevance_score)})]}),x.jsxs("div",{className:"bg-white rounded p-2 border",children:[x.jsx("div",{className:"text-xs text-gray-600",children:"Authority"}),x.jsx("div",{className:"text-sm font-bold text-gray-800",children:l(s.authority_score)})]}),x.jsxs("div",{className:"bg-white rounded p-2 border",children:[x.jsx("div",{className:"text-xs text-gray-600",children:"Completeness"}),x.jsx("div",{className:"text-sm font-bold text-gray-800",children:l(s.completeness_score)})]}),x.jsxs("div",{className:"bg-white rounded p-2 border",children:[x.jsx("div",{className:"text-xs text-gray-600",children:"Recency"}),x.jsx("div",{className:"text-sm font-bold text-gray-800",children:l(s.recency_score)})]}),x.jsxs("div",{className:"bg-white rounded p-2 border",children:[x.jsx("div",{className:"text-xs text-gray-600",children:"Consistency"}),x.jsx("div",{className:"text-sm font-bold text-gray-800",children:l(s.consistency_score)})]}),x.jsxs("div",{className:"bg-white rounded p-2 border",children:[x.jsx("div",{className:"text-xs text-gray-600",children:"Overall"}),x.jsx("div",{className:"text-sm font-bold "+(s.overall_confidence>=.6?"text-green-800":"text-red-800"),children:l(s.overall_confidence)})]})]})]}),s.assessment_reasoning&&x.jsxs("div",{children:[x.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"AI Assessment Reasoning:"}),x.jsx("div",{className:"text-xs text-gray-700 bg-white rounded p-3 border border-gray-200",children:x.jsx("div",{className:"whitespace-pre-wrap leading-relaxed",children:s.assessment_reasoning})})]}),s.quality_feedback&&s.quality_feedback.length>0&&x.jsxs("div",{children:[x.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"Quality Feedback:"}),x.jsx("div",{className:"space-y-1",children:s.quality_feedback.map((e,s)=>x.jsxs("div",{className:"text-xs text-gray-700 bg-white rounded p-2 border border-gray-200 flex items-start",children:[x.jsx("div",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full mr-2 mt-1.5 flex-shrink-0"}),x.jsx("div",{children:e})]},s))})]}),s.improvement_suggestions&&s.improvement_suggestions.length>0&&x.jsxs("div",{children:[x.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"Improvement Suggestions:"}),x.jsx("div",{className:"space-y-1",children:s.improvement_suggestions.map((e,s)=>x.jsxs("div",{className:"text-xs text-gray-700 bg-blue-50 rounded p-2 border border-blue-200 flex items-start",children:[x.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mr-2 mt-1.5 flex-shrink-0"}),x.jsx("div",{children:e})]},s))})]}),s.source_breakdown&&s.source_breakdown.length>0&&x.jsxs("div",{children:[x.jsx("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Source Quality Breakdown:"}),x.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto scrollbar-thin",children:s.source_breakdown.map((e,s)=>x.jsxs("div",{className:"bg-white rounded p-2 border border-gray-200",children:[x.jsxs("div",{className:"flex items-center justify-between mb-1",children:[x.jsx("div",{className:"text-xs font-medium text-gray-800 truncate",children:e.title}),x.jsx("div",{className:"text-xs px-2 py-1 rounded "+(e.passed_quality?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:e.passed_quality?"PASS":"FAIL"})]}),x.jsx("div",{className:"text-xs text-blue-600 mb-1 truncate",children:e.url}),x.jsxs("div",{className:"flex gap-2 text-xs",children:[x.jsxs("span",{children:["Auth: ",l(e.authority_score)]}),x.jsxs("span",{children:["Rel: ",l(e.relevance_score)]}),x.jsx("span",{className:"text-gray-500",children:e.source_type})]})]},s))})]})]})})]});var i},J=({stage:s,stageIndex:t,progress:a})=>{var r,l,i,d,n,c,o,m,u,g,h,p,b,f,j,v,N,y,_,w,k,C,S,A,R,M,q,P,E,F,I,T,D,$,O,L,Q,z,U,B,G,K,J,V,X,Z,ee;const se="Research Planning"===s.name,te="Information Gathering"===s.name,ae="Quality Evaluation"===s.name,re="Content Summarization"===s.name||"content_summarization"===s.name,le="Report Assembly"===s.name||"Synthesis"===s.name,[ie,de]=e.useState(!1),ne=(e=>{switch(e){case"completed":return{icon:"fas fa-check-circle",color:"text-green-500"};case"in_progress":return{icon:"fas fa-spinner fa-spin",color:"text-blue-500"};case"pending":return{icon:"fas fa-clock",color:"text-gray-400"};default:return{icon:"fas fa-exclamation-circle",color:"text-red-500"}}})(s.status),ce=s.details&&Object.keys(s.details).length>0,oe=ce||se||te||ae||re||le;return x.jsxs("div",{className:"bg-white border rounded-lg overflow-hidden",children:[x.jsxs("div",{className:"flex items-center justify-between p-3 cursor-pointer transition-colors "+(oe?"hover:bg-gray-50":""),onClick:()=>oe&&de(!ie),children:[x.jsxs("div",{className:"flex items-center space-x-3",children:[x.jsx("i",{className:`${ne.icon} ${ne.color}`}),x.jsx("span",{className:"text-sm font-medium text-gray-800",children:s.name}),oe&&x.jsx("i",{className:`fas fa-chevron-${ie?"up":"down"} text-xs text-gray-400 transition-transform`})]}),x.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[(null==(r=s.details)?void 0:r.tokens_used)>0&&x.jsxs("span",{className:"bg-green-100 text-green-700 px-2 py-1 rounded",children:[s.details.tokens_used," tokens"]}),(null==(l=s.details)?void 0:l.duration)>0&&x.jsxs("span",{className:"bg-blue-100 text-blue-700 px-2 py-1 rounded",children:[s.details.duration.toFixed(1),"s"]}),(null==(i=s.details)?void 0:i.api_calls)>0&&x.jsxs("span",{className:"bg-purple-100 text-purple-700 px-2 py-1 rounded",children:[s.details.api_calls," calls"]})]})]}),ie&&oe&&x.jsx("div",{className:"border-t bg-gray-50 p-3",children:se?x.jsxs("div",{className:"space-y-4",children:[ce&&x.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-cogs text-blue-500 mr-2"}),"Stage Performance Details"]}),x.jsxs("div",{className:"space-y-3",children:[x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-xs",children:[s.details.current_operation&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Current Operation"}),x.jsx("div",{className:"text-gray-800",children:s.details.current_operation})]}),s.details.agent&&"Unknown"!==s.details.agent&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Agent"}),x.jsxs("div",{className:"text-gray-800 flex items-center",children:[x.jsx("i",{className:"fas fa-robot mr-1 text-blue-500"}),s.details.agent.replace("Agent","")]})]}),s.details.timestamp&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Last Updated"}),x.jsx("div",{className:"text-gray-800",children:new Date(s.details.timestamp).toLocaleTimeString()})]})]}),(s.details.tokens_used>0||s.details.api_calls>0||s.details.duration>0||s.details.cost_so_far>0)&&x.jsxs("div",{className:"border-t pt-3",children:[x.jsx("div",{className:"font-medium text-gray-600 mb-2 text-xs",children:"Performance Metrics"}),x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[s.details.tokens_used>0&&x.jsxs("div",{className:"bg-green-50 p-2 rounded border border-green-100",children:[x.jsx("div",{className:"text-xs font-medium text-green-700",children:s.details.tokens_used.toLocaleString()}),x.jsx("div",{className:"text-xs text-green-600",children:"Tokens"})]}),s.details.api_calls>0&&x.jsxs("div",{className:"bg-purple-50 p-2 rounded border border-purple-100",children:[x.jsx("div",{className:"text-xs font-medium text-purple-700",children:s.details.api_calls}),x.jsx("div",{className:"text-xs text-purple-600",children:"API Calls"})]}),s.details.duration>0&&x.jsxs("div",{className:"bg-blue-50 p-2 rounded border border-blue-100",children:[x.jsxs("div",{className:"text-xs font-medium text-blue-700",children:[s.details.duration.toFixed(1),"s"]}),x.jsx("div",{className:"text-xs text-blue-600",children:"Duration"})]}),s.details.cost_so_far>0&&x.jsxs("div",{className:"bg-yellow-50 p-2 rounded border border-yellow-100",children:[x.jsxs("div",{className:"text-xs font-medium text-yellow-700",children:["$",s.details.cost_so_far.toFixed(4)]}),x.jsx("div",{className:"text-xs text-yellow-600",children:"Cost"})]})]})]}),(s.details.model_used||s.details.sources_found>0)&&x.jsxs("div",{className:"border-t pt-3",children:[x.jsx("div",{className:"font-medium text-gray-600 mb-2 text-xs",children:"Additional Details"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-xs",children:[s.details.model_used&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Model Used"}),x.jsx("div",{className:"text-gray-800 font-mono text-xs bg-gray-100 px-2 py-1 rounded",children:s.details.model_used.replace("accounts/fireworks/models/","")})]}),s.details.sources_found>0&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Sources Found"}),x.jsxs("div",{className:"text-gray-800 flex items-center",children:[x.jsx("i",{className:"fas fa-link mr-1 text-gray-500"}),s.details.sources_found," sources"]})]})]})]})]})]}),x.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-brain text-indigo-500 mr-2"}),"AI Research Plan Analysis"]}),x.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[x.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Research Query:"}),x.jsxs("div",{className:"text-sm font-medium text-gray-800 italic",children:['"',(null==(d=null==a?void 0:a.research_plan)?void 0:d.main_query)||"Loading...",'"']})]}),(null==(n=null==a?void 0:a.research_plan)?void 0:n.research_strategy)&&x.jsxs("div",{className:"bg-indigo-50 rounded-lg p-3 mb-3 border border-indigo-200",children:[x.jsxs("div",{className:"text-sm font-semibold text-indigo-700 mb-2 flex items-center",children:[x.jsx("i",{className:"fas fa-lightbulb mr-1"}),"AI Research Strategy"]}),x.jsx("div",{className:"text-sm text-gray-700",children:a.research_plan.research_strategy})]}),(null==a?void 0:a.research_plan)?x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-3",children:[x.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-blue-700 mb-2",children:[x.jsx("i",{className:"fas fa-brain mr-1"}),"Research Complexity"]}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsxs("div",{className:"text-sm font-bold text-blue-800",children:["Level ",a.research_plan.estimated_complexity,"/5"]}),x.jsxs("div",{className:"text-xs text-blue-600",children:["Est. ",Math.round(a.research_plan.estimated_duration||0),"min"]})]}),x.jsx("div",{className:"text-lg",children:a.research_plan.estimated_complexity<=2?"üü¢":a.research_plan.estimated_complexity<=3?"üü°":"üî¥"})]})]}),x.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-green-700 mb-2",children:[x.jsx("i",{className:"fas fa-tags mr-1"}),"Research Categories"]}),x.jsx("div",{className:"flex flex-wrap gap-1",children:(a.research_plan.categories||[]).map((e,s)=>x.jsx("span",{className:"inline-block bg-green-100 text-green-700 text-xs px-2 py-1 rounded-full",children:e},s))})]}),x.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-purple-700 mb-2",children:[x.jsx("i",{className:"fas fa-list-ol mr-1"}),"Sub-Questions"]}),x.jsx("div",{className:"text-lg font-bold text-purple-800",children:(null==(c=a.research_plan.sub_questions)?void 0:c.length)||0}),x.jsx("div",{className:"text-xs text-purple-600",children:"AI-generated"})]})]}):x.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[x.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-indigo-600 mx-auto mb-2"}),x.jsx("div",{className:"text-sm text-gray-600",children:"AI is analyzing your query..."}),x.jsx("div",{className:"text-xs text-gray-500",children:"Generating research strategy and sub-questions"})]}),(null==(o=null==a?void 0:a.research_plan)?void 0:o.sub_questions)&&a.research_plan.sub_questions.length>0&&x.jsxs("div",{className:"bg-indigo-50 rounded-lg p-3 border border-indigo-200",children:[x.jsxs("div",{className:"text-sm font-semibold text-indigo-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-list-ol mr-1"}),"AI-Generated Research Questions (",a.research_plan.sub_questions.length,")"]}),x.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto scrollbar-thin",children:a.research_plan.sub_questions.map((e,s)=>x.jsx("div",{className:"bg-white rounded-lg p-3 border border-indigo-100 shadow-sm",children:x.jsx("div",{className:"flex items-start justify-between mb-2",children:x.jsxs("div",{className:"flex-1",children:[x.jsxs("div",{className:"text-sm font-medium text-gray-800 mb-1",children:[x.jsx("span",{className:"bg-indigo-100 text-indigo-700 px-2 py-1 rounded-full text-xs font-bold mr-2",children:e.id}),e.question]}),x.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[x.jsxs("span",{className:"px-2 py-1 rounded-full font-medium "+(1===e.priority?"bg-red-100 text-red-700":2===e.priority?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"),children:["Priority ",e.priority]}),x.jsx("span",{className:"bg-blue-100 text-blue-700 px-2 py-1 rounded-full font-medium",children:e.category})]}),e.search_terms&&e.search_terms.length>0&&x.jsxs("div",{className:"mt-2 text-xs text-gray-600 bg-gray-50 rounded p-2",children:[x.jsx("i",{className:"fas fa-search mr-1"}),x.jsx("strong",{children:"Search Terms:"})," ",e.search_terms.join(", ")]})]})})},s))})]})]})]}):te?x.jsxs("div",{className:"space-y-4",children:[ce&&x.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-cogs text-blue-500 mr-2"}),"Stage Performance Details"]}),x.jsxs("div",{className:"space-y-3",children:[x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-xs",children:[s.details.current_operation&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Current Operation"}),x.jsx("div",{className:"text-gray-800",children:s.details.current_operation})]}),s.details.agent&&"Unknown"!==s.details.agent&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Agent"}),x.jsxs("div",{className:"text-gray-800 flex items-center",children:[x.jsx("i",{className:"fas fa-robot mr-1 text-blue-500"}),s.details.agent.replace("Agent","")]})]}),s.details.timestamp&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Last Updated"}),x.jsx("div",{className:"text-gray-800",children:new Date(s.details.timestamp).toLocaleTimeString()})]})]}),(s.details.tokens_used>0||s.details.api_calls>0||s.details.duration>0||s.details.cost_so_far>0)&&x.jsxs("div",{className:"border-t pt-3",children:[x.jsx("div",{className:"font-medium text-gray-600 mb-2 text-xs",children:"Performance Metrics"}),x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[s.details.tokens_used>0&&x.jsxs("div",{className:"bg-green-50 p-2 rounded border border-green-100",children:[x.jsx("div",{className:"text-xs font-medium text-green-700",children:s.details.tokens_used.toLocaleString()}),x.jsx("div",{className:"text-xs text-green-600",children:"Tokens"})]}),s.details.api_calls>0&&x.jsxs("div",{className:"bg-purple-50 p-2 rounded border border-purple-100",children:[x.jsx("div",{className:"text-xs font-medium text-purple-700",children:s.details.api_calls}),x.jsx("div",{className:"text-xs text-purple-600",children:"API Calls"})]}),s.details.duration>0&&x.jsxs("div",{className:"bg-blue-50 p-2 rounded border border-blue-100",children:[x.jsxs("div",{className:"text-xs font-medium text-blue-700",children:[s.details.duration.toFixed(1),"s"]}),x.jsx("div",{className:"text-xs text-blue-600",children:"Duration"})]}),s.details.cost_so_far>0&&x.jsxs("div",{className:"bg-yellow-50 p-2 rounded border border-yellow-100",children:[x.jsxs("div",{className:"text-xs font-medium text-yellow-700",children:["$",s.details.cost_so_far.toFixed(4)]}),x.jsx("div",{className:"text-xs text-yellow-600",children:"Cost"})]})]})]}),(s.details.model_used||s.details.sources_found>0)&&x.jsxs("div",{className:"border-t pt-3",children:[x.jsx("div",{className:"font-medium text-gray-600 mb-2 text-xs",children:"Additional Details"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-xs",children:[s.details.model_used&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Model Used"}),x.jsx("div",{className:"text-gray-800 font-mono text-xs bg-gray-100 px-2 py-1 rounded",children:s.details.model_used.replace("accounts/fireworks/models/","")})]}),s.details.sources_found>0&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Sources Found"}),x.jsxs("div",{className:"text-gray-800 flex items-center",children:[x.jsx("i",{className:"fas fa-link mr-1 text-gray-500"}),s.details.sources_found," sources"]})]})]})]})]})]}),x.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-globe text-emerald-500 mr-2"}),"Information Sources & Content"]}),x.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[x.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Current Status:"}),x.jsx("div",{className:"text-sm font-medium text-gray-800",children:(null==(m=s.details)?void 0:m.current_operation)||"Gathering information from web sources..."})]}),((null==(u=s.details)?void 0:u.sources_found)>0||(null==(g=s.details)?void 0:g.sources))&&x.jsxs("div",{className:"bg-emerald-50 rounded-lg p-3 mb-3 border border-emerald-200",children:[x.jsxs("div",{className:"text-sm font-semibold text-emerald-700 mb-2 flex items-center",children:[x.jsx("i",{className:"fas fa-chart-bar mr-1"}),"Sources Discovery Summary"]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-emerald-700 mb-2",children:[x.jsx("i",{className:"fas fa-link mr-1"}),"Sources Found"]}),x.jsx("div",{className:"text-lg font-bold text-emerald-800",children:(null==(p=null==(h=s.details)?void 0:h.sources)?void 0:p.length)||(null==(b=s.details)?void 0:b.sources_found)||0}),x.jsx("div",{className:"text-xs text-emerald-600",children:"Unique websites"})]}),x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-blue-700 mb-2",children:[x.jsx("i",{className:"fas fa-file-alt mr-1"}),"Content Extracted"]}),x.jsx("div",{className:"text-lg font-bold text-blue-800",children:(null==(j=null==(f=s.details)?void 0:f.sources)?void 0:j.filter(e=>e.snippet&&e.snippet.length>0).length)||0}),x.jsx("div",{className:"text-xs text-blue-600",children:"With content"})]}),x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-purple-700 mb-2",children:[x.jsx("i",{className:"fas fa-check-circle mr-1"}),"Status"]}),x.jsx("div",{className:"text-sm font-bold text-purple-800",children:"completed"===s.status?"Complete":"in_progress"===s.status?"In Progress":"Pending"}),x.jsx("div",{className:"text-xs text-purple-600",children:"completed"===s.status?"‚úÖ":"in_progress"===s.status?"üîÑ":"‚è≥"})]})]})]}),console.log(`üîç Stage ${s.name} - Sources check:`,{hasDetails:!!s.details,hasSources:!!(null==(v=s.details)?void 0:v.sources),sourcesLength:(null==(y=null==(N=s.details)?void 0:N.sources)?void 0:y.length)||0,sourcesData:(null==(w=null==(_=s.details)?void 0:_.sources)?void 0:w.slice(0,2))||"No sources"}),(null==(k=s.details)?void 0:k.source_filtering)?x.jsx(Y,{filteringData:s.details.source_filtering}):(null==(C=s.details)?void 0:C.sources)&&s.details.sources.length>0?x.jsxs("div",{className:"bg-emerald-50 rounded-lg p-3 border border-emerald-200",children:[x.jsxs("div",{className:"text-sm font-semibold text-emerald-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-list-ul mr-1"}),"Discovered Sources (",s.details.sources.length,")"]}),x.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto scrollbar-thin",children:s.details.sources.map((e,s)=>x.jsx(W,{source:e,index:s},s))})]}):x.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[x.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-emerald-600 mx-auto mb-2"}),x.jsx("div",{className:"text-sm text-gray-600",children:"Discovering and analyzing web sources..."}),x.jsx("div",{className:"text-xs text-gray-500",children:"Searching for relevant information across the web"})]})]})]}):ae?x.jsxs("div",{className:"space-y-4",children:[ce&&x.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-cogs text-blue-500 mr-2"}),"Stage Performance Details"]}),x.jsxs("div",{className:"space-y-3",children:[x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-xs",children:[s.details.current_operation&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Current Operation"}),x.jsx("div",{className:"text-gray-800",children:s.details.current_operation})]}),s.details.agent&&"Unknown"!==s.details.agent&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Agent"}),x.jsxs("div",{className:"text-gray-800 flex items-center",children:[x.jsx("i",{className:"fas fa-robot mr-1 text-blue-500"}),s.details.agent.replace("Agent","")]})]}),s.details.timestamp&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Last Updated"}),x.jsx("div",{className:"text-gray-800",children:new Date(s.details.timestamp).toLocaleTimeString()})]})]}),(s.details.tokens_used>0||s.details.api_calls>0||s.details.duration>0||s.details.cost_so_far>0)&&x.jsxs("div",{className:"border-t pt-3",children:[x.jsx("div",{className:"font-medium text-gray-600 mb-2 text-xs",children:"Performance Metrics"}),x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[s.details.tokens_used>0&&x.jsxs("div",{className:"bg-green-50 p-2 rounded border border-green-100",children:[x.jsx("div",{className:"text-xs font-medium text-green-700",children:s.details.tokens_used.toLocaleString()}),x.jsx("div",{className:"text-xs text-green-600",children:"Tokens"})]}),s.details.api_calls>0&&x.jsxs("div",{className:"bg-purple-50 p-2 rounded border border-purple-100",children:[x.jsx("div",{className:"text-xs font-medium text-purple-700",children:s.details.api_calls}),x.jsx("div",{className:"text-xs text-purple-600",children:"API Calls"})]}),s.details.duration>0&&x.jsxs("div",{className:"bg-blue-50 p-2 rounded border border-blue-100",children:[x.jsxs("div",{className:"text-xs font-medium text-blue-700",children:[s.details.duration.toFixed(1),"s"]}),x.jsx("div",{className:"text-xs text-blue-600",children:"Duration"})]}),s.details.cost_so_far>0&&x.jsxs("div",{className:"bg-yellow-50 p-2 rounded border border-yellow-100",children:[x.jsxs("div",{className:"text-xs font-medium text-yellow-700",children:["$",s.details.cost_so_far.toFixed(4)]}),x.jsx("div",{className:"text-xs text-yellow-600",children:"Cost"})]})]})]}),(s.details.model_used||s.details.sources_found>0)&&x.jsxs("div",{className:"border-t pt-3",children:[x.jsx("div",{className:"font-medium text-gray-600 mb-2 text-xs",children:"Additional Details"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-xs",children:[s.details.model_used&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Model Used"}),x.jsx("div",{className:"text-gray-800 font-mono text-xs bg-gray-100 px-2 py-1 rounded",children:s.details.model_used.replace("accounts/fireworks/models/","")})]}),s.details.sources_found>0&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Sources Found"}),x.jsxs("div",{className:"text-gray-800 flex items-center",children:[x.jsx("i",{className:"fas fa-link mr-1 text-gray-500"}),s.details.sources_found," sources"]})]})]})]})]})]}),x.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-microscope text-amber-500 mr-2"}),"AI Quality Assessment Results"]}),x.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[x.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Current Status:"}),x.jsx("div",{className:"text-sm font-medium text-gray-800",children:(null==(S=s.details)?void 0:S.current_operation)||"Evaluating information quality and relevance..."})]}),console.log("üîç Quality Evaluation Debug:",{stageName:s.name,hasDetails:!!s.details,hasQualityEvaluations:!!(null==(A=s.details)?void 0:A.quality_evaluations),qualityEvaluationsLength:(null==(M=null==(R=s.details)?void 0:R.quality_evaluations)?void 0:M.length)||0,qualityEvaluationsData:(null==(P=null==(q=s.details)?void 0:q.quality_evaluations)?void 0:P.slice(0,1))||"No evaluations",allStageDetails:s.details}),(null==(E=s.details)?void 0:E.quality_evaluations)&&s.details.quality_evaluations.length>0?x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"bg-amber-50 rounded-lg p-3 border border-amber-200",children:[x.jsxs("div",{className:"text-sm font-semibold text-amber-700 mb-2 flex items-center",children:[x.jsx("i",{className:"fas fa-chart-line mr-1"}),"Quality Assessment Summary"]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-amber-700 mb-2",children:[x.jsx("i",{className:"fas fa-clipboard-check mr-1"}),"Evaluations"]}),x.jsx("div",{className:"text-lg font-bold text-amber-800",children:s.details.quality_evaluations.length}),x.jsx("div",{className:"text-xs text-amber-600",children:"Sub-questions"})]}),x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-green-700 mb-2",children:[x.jsx("i",{className:"fas fa-check-circle mr-1"}),"Passed"]}),x.jsx("div",{className:"text-lg font-bold text-green-800",children:s.details.quality_evaluations.filter(e=>"PASS"===e.pass_fail_status).length}),x.jsx("div",{className:"text-xs text-green-600",children:"Quality checks"})]}),x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-red-700 mb-2",children:[x.jsx("i",{className:"fas fa-times-circle mr-1"}),"Failed"]}),x.jsx("div",{className:"text-lg font-bold text-red-800",children:s.details.quality_evaluations.filter(e=>"FAIL"===e.pass_fail_status).length}),x.jsx("div",{className:"text-xs text-red-600",children:"Quality checks"})]}),x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-blue-700 mb-2",children:[x.jsx("i",{className:"fas fa-star mr-1"}),"Avg Grade"]}),x.jsx("div",{className:"text-lg font-bold text-blue-800",children:s.details.quality_evaluations.length>0?Math.round(s.details.quality_evaluations.reduce((e,s)=>e+s.overall_confidence,0)/s.details.quality_evaluations.length*100)+"%":"N/A"}),x.jsx("div",{className:"text-xs text-blue-600",children:"Confidence"})]})]})]}),x.jsxs("div",{className:"bg-amber-50 rounded-lg p-3 border border-amber-200",children:[x.jsxs("div",{className:"text-sm font-semibold text-amber-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-list-ul mr-1"}),"Detailed Quality Assessment Results"]}),x.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto scrollbar-thin",children:s.details.quality_evaluations.map((e,s)=>x.jsx(H,{evaluation:e,index:s},s))})]})]}):x.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[x.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-amber-600 mx-auto mb-2"}),x.jsx("div",{className:"text-sm text-gray-600",children:"Running quality assessment..."}),x.jsx("div",{className:"text-xs text-gray-500",children:"AI is evaluating source quality and relevance"})]})]})]}):re?x.jsxs("div",{className:"space-y-4",children:[ce&&x.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-cogs text-blue-500 mr-2"}),"Stage Performance Details"]}),x.jsxs("div",{className:"space-y-3",children:[x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-xs",children:[s.details.current_operation&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Current Operation"}),x.jsx("div",{className:"text-gray-800",children:s.details.current_operation})]}),s.details.agent&&"Unknown"!==s.details.agent&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Agent"}),x.jsxs("div",{className:"text-gray-800 flex items-center",children:[x.jsx("i",{className:"fas fa-robot mr-1 text-blue-500"}),s.details.agent.replace("Agent","")]})]}),s.details.timestamp&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Last Updated"}),x.jsx("div",{className:"text-gray-800",children:new Date(s.details.timestamp).toLocaleTimeString()})]})]}),(s.details.tokens_used>0||s.details.api_calls>0||s.details.duration>0||s.details.cost_so_far>0)&&x.jsxs("div",{className:"border-t pt-3",children:[x.jsx("div",{className:"font-medium text-gray-600 mb-2 text-xs",children:"Performance Metrics"}),x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[s.details.tokens_used>0&&x.jsxs("div",{className:"bg-green-50 p-2 rounded border border-green-100",children:[x.jsx("div",{className:"text-xs font-medium text-green-700",children:s.details.tokens_used.toLocaleString()}),x.jsx("div",{className:"text-xs text-green-600",children:"Tokens"})]}),s.details.api_calls>0&&x.jsxs("div",{className:"bg-purple-50 p-2 rounded border border-purple-100",children:[x.jsx("div",{className:"text-xs font-medium text-purple-700",children:s.details.api_calls}),x.jsx("div",{className:"text-xs text-purple-600",children:"API Calls"})]}),s.details.duration>0&&x.jsxs("div",{className:"bg-blue-50 p-2 rounded border border-blue-100",children:[x.jsxs("div",{className:"text-xs font-medium text-blue-700",children:[s.details.duration.toFixed(1),"s"]}),x.jsx("div",{className:"text-xs text-blue-600",children:"Duration"})]}),s.details.cost_so_far>0&&x.jsxs("div",{className:"bg-yellow-50 p-2 rounded border border-yellow-100",children:[x.jsxs("div",{className:"text-xs font-medium text-yellow-700",children:["$",s.details.cost_so_far.toFixed(4)]}),x.jsx("div",{className:"text-xs text-yellow-600",children:"Cost"})]})]})]}),(s.details.model_used||s.details.sources_found>0)&&x.jsxs("div",{className:"border-t pt-3",children:[x.jsx("div",{className:"font-medium text-gray-600 mb-2 text-xs",children:"Additional Details"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-xs",children:[s.details.model_used&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Model Used"}),x.jsx("div",{className:"text-gray-800 font-mono text-xs bg-gray-100 px-2 py-1 rounded",children:s.details.model_used.replace("accounts/fireworks/models/","")})]}),s.details.sources_found>0&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Sources Found"}),x.jsxs("div",{className:"text-gray-800 flex items-center",children:[x.jsx("i",{className:"fas fa-link mr-1 text-gray-500"}),s.details.sources_found," sources"]})]})]})]})]})]}),x.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-magic text-indigo-500 mr-2"}),"AI Content Summarization Results"]}),x.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[x.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Current Status:"}),x.jsx("div",{className:"text-sm font-medium text-gray-800",children:(null==(F=s.details)?void 0:F.current_operation)||"Analyzing and summarizing content..."})]}),console.log("üîç Content Summarization Debug:",{stageName:s.name,hasDetails:!!s.details,hasSummaries:!(!(null==(I=s.details)?void 0:I.summaries)&&!(null==a?void 0:a.summaries)),summariesLength:((null==(T=s.details)?void 0:T.summaries)||(null==a?void 0:a.summaries)||[]).length,summariesData:((null==(D=s.details)?void 0:D.summaries)||(null==a?void 0:a.summaries)||[]).slice(0,1),progressData:a,allStageDetails:s.details}),((null==($=s.details)?void 0:$.summaries)||(null==a?void 0:a.summaries))&&((null==(O=s.details)?void 0:O.summaries)||(null==a?void 0:a.summaries)).length>0?x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"bg-indigo-50 rounded-lg p-3 border border-indigo-200",children:[x.jsxs("div",{className:"text-sm font-semibold text-indigo-700 mb-2 flex items-center",children:[x.jsx("i",{className:"fas fa-chart-bar mr-1"}),"Summarization Overview"]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-indigo-700 mb-2",children:[x.jsx("i",{className:"fas fa-file-alt mr-1"}),"Summaries"]}),x.jsx("div",{className:"text-lg font-bold text-indigo-800",children:((null==(L=s.details)?void 0:L.summaries)||(null==a?void 0:a.summaries)||[]).length}),x.jsx("div",{className:"text-xs text-indigo-600",children:"Generated"})]}),x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-green-700 mb-2",children:[x.jsx("i",{className:"fas fa-check-circle mr-1"}),"High Confidence"]}),x.jsx("div",{className:"text-lg font-bold text-green-800",children:((null==(Q=s.details)?void 0:Q.summaries)||(null==a?void 0:a.summaries)||[]).filter(e=>e.confidence_level>=.8).length}),x.jsx("div",{className:"text-xs text-green-600",children:"‚â•80% confidence"})]}),x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-blue-700 mb-2",children:[x.jsx("i",{className:"fas fa-brain mr-1"}),"Avg Confidence"]}),x.jsx("div",{className:"text-lg font-bold text-blue-800",children:((null==(z=s.details)?void 0:z.summaries)||(null==a?void 0:a.summaries)||[]).length>0?Math.round(((null==(U=s.details)?void 0:U.summaries)||(null==a?void 0:a.summaries)||[]).reduce((e,s)=>e+(s.confidence_level||0),0)/((null==(B=s.details)?void 0:B.summaries)||(null==a?void 0:a.summaries)||[]).length*100)+"%":"N/A"}),x.jsx("div",{className:"text-xs text-blue-600",children:"Overall"})]}),x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-purple-700 mb-2",children:[x.jsx("i",{className:"fas fa-file-word mr-1"}),"Total Words"]}),x.jsx("div",{className:"text-lg font-bold text-purple-800",children:((null==(G=s.details)?void 0:G.summaries)||(null==a?void 0:a.summaries)||[]).reduce((e,s)=>e+(s.word_count||0),0).toLocaleString()}),x.jsx("div",{className:"text-xs text-purple-600",children:"Generated"})]})]})]}),x.jsxs("div",{className:"bg-indigo-50 rounded-lg p-3 border border-indigo-200",children:[x.jsxs("div",{className:"text-sm font-semibold text-indigo-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-list-ul mr-1"}),"Research Question Summaries"]}),x.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto scrollbar-thin",children:((null==(K=s.details)?void 0:K.summaries)||(null==a?void 0:a.summaries)||[]).map((e,s)=>x.jsxs("div",{className:"bg-white rounded-lg p-4 border border-indigo-100 shadow-sm",children:[x.jsx("div",{className:"flex items-start justify-between mb-3",children:x.jsxs("div",{className:"flex-1",children:[x.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[x.jsx("div",{className:"flex items-center justify-center w-6 h-6 bg-indigo-100 text-indigo-600 rounded-full text-xs font-bold",children:e.sub_question_id||s+1}),x.jsx("div",{className:"text-sm font-medium text-gray-800",children:e.question})]}),x.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[x.jsxs("span",{className:"px-2 py-1 rounded-full font-medium "+((e.confidence_level||0)>=.8?"bg-green-100 text-green-700":(e.confidence_level||0)>=.6?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:[Math.round(100*(e.confidence_level||0)),"% confidence"]}),e.word_count&&x.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded-full font-medium",children:[e.word_count," words"]}),e.processing_time&&x.jsxs("span",{className:"bg-blue-100 text-blue-700 px-2 py-1 rounded-full font-medium",children:[e.processing_time.toFixed(1),"s"]})]})]})}),x.jsxs("div",{className:"mb-3",children:[x.jsxs("div",{className:"text-xs font-medium text-gray-700 mb-2",children:[x.jsx("i",{className:"fas fa-lightbulb mr-1 text-indigo-500"}),"AI Generated Answer:"]}),x.jsx("div",{className:"text-sm text-gray-800 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-3 border border-indigo-100",children:e.answer})]}),e.key_points&&e.key_points.length>0&&x.jsxs("div",{className:"mb-3",children:[x.jsxs("div",{className:"text-xs font-medium text-gray-700 mb-2",children:[x.jsx("i",{className:"fas fa-list-ul mr-1 text-indigo-500"}),"Key Points (",e.key_points.length,"):"]}),x.jsx("div",{className:"space-y-2",children:e.key_points.map((e,s)=>x.jsxs("div",{className:"text-sm text-gray-700 bg-white rounded-lg p-2 border border-gray-200 flex items-start",children:[x.jsx("div",{className:"w-1.5 h-1.5 bg-indigo-500 rounded-full mr-2 mt-1.5 flex-shrink-0"}),x.jsx("div",{children:e})]},s))})]}),e.sources&&e.sources.length>0&&x.jsxs("div",{className:"mb-3",children:[x.jsxs("div",{className:"text-xs font-medium text-gray-700 mb-2",children:[x.jsx("i",{className:"fas fa-link mr-1 text-indigo-500"}),"Sources Used (",e.sources.length,"):"]}),x.jsx("div",{className:"flex flex-wrap gap-1",children:e.sources.map((e,s)=>x.jsxs("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded hover:bg-blue-100 transition-colors",children:["Source ",s+1]},s))})]}),x.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-gray-100",children:[x.jsxs("button",{onClick:()=>{const s=`Question: ${e.question}\n\nAnswer: ${e.answer}\n\nKey Points:\n${(e.key_points||[]).map(e=>`‚Ä¢ ${e}`).join("\n")}`;navigator.clipboard.writeText(s)},className:"text-xs text-gray-600 hover:text-gray-800 flex items-center gap-1",children:[x.jsx("i",{className:"fas fa-copy"}),x.jsx("span",{children:"Copy Summary"})]}),x.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(e.answer)},className:"text-xs text-gray-600 hover:text-gray-800 flex items-center gap-1",children:[x.jsx("i",{className:"fas fa-quote-left"}),x.jsx("span",{children:"Copy Answer"})]})]})]},s))})]})]}):x.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[x.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-indigo-600 mx-auto mb-2"}),x.jsx("div",{className:"text-sm text-gray-600",children:"Generating content summaries..."}),x.jsx("div",{className:"text-xs text-gray-500",children:"AI is analyzing and summarizing research findings"})]})]})]}):le?x.jsxs("div",{className:"space-y-4",children:[ce&&x.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-cogs text-blue-500 mr-2"}),"Stage Performance Details"]}),x.jsxs("div",{className:"space-y-3",children:[x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-xs",children:[s.details.current_operation&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Current Operation"}),x.jsx("div",{className:"text-gray-800",children:s.details.current_operation})]}),s.details.agent&&"Unknown"!==s.details.agent&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Agent"}),x.jsxs("div",{className:"text-gray-800 flex items-center",children:[x.jsx("i",{className:"fas fa-robot mr-1 text-blue-500"}),s.details.agent.replace("Agent","")]})]}),s.details.timestamp&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Last Updated"}),x.jsx("div",{className:"text-gray-800",children:new Date(s.details.timestamp).toLocaleTimeString()})]})]}),(s.details.tokens_used>0||s.details.api_calls>0||s.details.duration>0||s.details.cost_so_far>0)&&x.jsxs("div",{className:"border-t pt-3",children:[x.jsx("div",{className:"font-medium text-gray-600 mb-2 text-xs",children:"Performance Metrics"}),x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[s.details.tokens_used>0&&x.jsxs("div",{className:"bg-green-50 p-2 rounded border border-green-100",children:[x.jsx("div",{className:"text-xs font-medium text-green-700",children:s.details.tokens_used.toLocaleString()}),x.jsx("div",{className:"text-xs text-green-600",children:"Tokens"})]}),s.details.api_calls>0&&x.jsxs("div",{className:"bg-purple-50 p-2 rounded border border-purple-100",children:[x.jsx("div",{className:"text-xs font-medium text-purple-700",children:s.details.api_calls}),x.jsx("div",{className:"text-xs text-purple-600",children:"API Calls"})]}),s.details.duration>0&&x.jsxs("div",{className:"bg-blue-50 p-2 rounded border border-blue-100",children:[x.jsxs("div",{className:"text-xs font-medium text-blue-700",children:[s.details.duration.toFixed(1),"s"]}),x.jsx("div",{className:"text-xs text-blue-600",children:"Duration"})]}),s.details.cost_so_far>0&&x.jsxs("div",{className:"bg-yellow-50 p-2 rounded border border-yellow-100",children:[x.jsxs("div",{className:"text-xs font-medium text-yellow-700",children:["$",s.details.cost_so_far.toFixed(4)]}),x.jsx("div",{className:"text-xs text-yellow-600",children:"Cost"})]})]})]})]})]}),x.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-file-alt text-emerald-500 mr-2"}),"Final Research Report"]}),x.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[x.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Assembly Status:"}),x.jsx("div",{className:"text-sm font-medium text-gray-800",children:(null==(J=s.details)?void 0:J.current_operation)||"Assembling final research report..."})]}),console.log("üìã Report Assembly Debug:",{stageName:s.name,hasDetails:!!s.details,hasFinalReport:!!(null==(V=s.details)?void 0:V.final_report),finalReportData:null==(X=s.details)?void 0:X.final_report,allStageDetails:s.details}),(null==(Z=s.details)?void 0:Z.final_report)?x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"bg-emerald-50 rounded-lg p-3 border border-emerald-200",children:[x.jsxs("div",{className:"text-sm font-semibold text-emerald-700 mb-2 flex items-center",children:[x.jsx("i",{className:"fas fa-chart-line mr-1"}),"Report Overview"]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-emerald-700 mb-2",children:[x.jsx("i",{className:"fas fa-list-alt mr-1"}),"Findings"]}),x.jsx("div",{className:"text-lg font-bold text-emerald-800",children:(s.details.final_report.detailed_findings||[]).length}),x.jsx("div",{className:"text-xs text-emerald-600",children:"Sections"})]}),x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-blue-700 mb-2",children:[x.jsx("i",{className:"fas fa-star mr-1"}),"Quality Score"]}),x.jsx("div",{className:"text-lg font-bold text-blue-800",children:s.details.final_report.quality_score?Math.round(100*s.details.final_report.quality_score)+"%":"N/A"}),x.jsx("div",{className:"text-xs text-blue-600",children:"Overall"})]}),x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-purple-700 mb-2",children:[x.jsx("i",{className:"fas fa-link mr-1"}),"Sources"]}),x.jsx("div",{className:"text-lg font-bold text-purple-800",children:(s.details.final_report.sources_cited||[]).length}),x.jsx("div",{className:"text-xs text-purple-600",children:"Referenced"})]}),x.jsxs("div",{className:"bg-white rounded-lg p-3",children:[x.jsxs("div",{className:"text-xs font-semibold text-amber-700 mb-2",children:[x.jsx("i",{className:"fas fa-file-word mr-1"}),"Word Count"]}),x.jsx("div",{className:"text-lg font-bold text-amber-800",children:(s.details.final_report.total_words||0).toLocaleString()}),x.jsx("div",{className:"text-xs text-amber-600",children:"Generated"})]})]})]}),console.log("üîç Final Report Data:",s.details.final_report)||"",console.log("üìã Executive Summary Value:",s.details.final_report.executive_summary)||"",console.log("üìã Executive Summary Type:",typeof s.details.final_report.executive_summary)||"",console.log("üìã Executive Summary Length:",null==(ee=s.details.final_report.executive_summary)?void 0:ee.length)||"",s.details.final_report.executive_summary&&s.details.final_report.executive_summary.trim()&&x.jsxs("div",{className:"bg-emerald-50 rounded-lg p-3 border border-emerald-200",children:[x.jsxs("div",{className:"text-sm font-semibold text-emerald-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-scroll mr-1"}),"Executive Summary"]}),x.jsx("div",{className:"text-sm text-gray-800 bg-white rounded-lg p-3 border border-emerald-100 leading-relaxed",children:s.details.final_report.executive_summary})]}),s.details.final_report.detailed_findings&&s.details.final_report.detailed_findings.length>0&&x.jsxs("div",{className:"bg-emerald-50 rounded-lg p-3 border border-emerald-200",children:[x.jsxs("div",{className:"text-sm font-semibold text-emerald-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-list-ol mr-1"}),"Detailed Research Findings"]}),x.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto scrollbar-thin",children:s.details.final_report.detailed_findings.map((e,s)=>x.jsxs("div",{className:"bg-white rounded-lg p-4 border border-emerald-100 shadow-sm",children:[x.jsxs("div",{className:"flex items-start justify-between mb-2",children:[x.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[x.jsx("div",{className:"flex items-center justify-center w-6 h-6 bg-emerald-100 text-emerald-600 rounded-full text-xs font-bold",children:s+1}),x.jsx("div",{className:"text-sm font-medium text-gray-800",children:e.question})]}),e.confidence_level&&x.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(e.confidence_level>=.8?"bg-green-100 text-green-700":e.confidence_level>=.6?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:[Math.round(100*e.confidence_level),"% confidence"]})]}),x.jsx("div",{className:"text-sm text-gray-800 bg-gradient-to-r from-emerald-50 to-green-50 rounded-lg p-3 border border-emerald-100 mb-3",children:e.answer}),e.key_points&&e.key_points.length>0&&x.jsxs("div",{className:"space-y-1",children:[x.jsxs("div",{className:"text-xs font-medium text-gray-700 mb-2",children:[x.jsx("i",{className:"fas fa-key mr-1 text-emerald-500"}),"Key Points:"]}),e.key_points.map((e,s)=>x.jsxs("div",{className:"text-sm text-gray-700 bg-gray-50 rounded-lg p-2 border border-gray-200 flex items-start",children:[x.jsx("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full mr-2 mt-1.5 flex-shrink-0"}),x.jsx("div",{children:e})]},s))]})]},s))})]}),s.details.final_report.recommendations&&s.details.final_report.recommendations.length>0&&x.jsxs("div",{className:"bg-emerald-50 rounded-lg p-3 border border-emerald-200",children:[x.jsxs("div",{className:"text-sm font-semibold text-emerald-700 mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-lightbulb mr-1"}),"Recommendations (",s.details.final_report.recommendations.length,")"]}),x.jsx("div",{className:"space-y-2",children:s.details.final_report.recommendations.map((e,s)=>x.jsxs("div",{className:"text-sm text-gray-800 bg-white rounded-lg p-3 border border-emerald-100 flex items-start",children:[x.jsx("div",{className:"flex items-center justify-center w-5 h-5 bg-emerald-100 text-emerald-600 rounded-full text-xs font-bold mr-3 flex-shrink-0 mt-0.5",children:s+1}),x.jsx("div",{children:e})]},s))})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.details.final_report.methodology&&x.jsxs("div",{className:"bg-emerald-50 rounded-lg p-3 border border-emerald-200",children:[x.jsxs("div",{className:"text-sm font-semibold text-emerald-700 mb-2 flex items-center",children:[x.jsx("i",{className:"fas fa-cogs mr-1"}),"Methodology"]}),x.jsx("div",{className:"text-sm text-gray-800 bg-white rounded-lg p-3 border border-emerald-100",children:s.details.final_report.methodology})]}),s.details.final_report.limitations&&s.details.final_report.limitations.length>0&&x.jsxs("div",{className:"bg-amber-50 rounded-lg p-3 border border-amber-200",children:[x.jsxs("div",{className:"text-sm font-semibold text-amber-700 mb-2 flex items-center",children:[x.jsx("i",{className:"fas fa-exclamation-triangle mr-1"}),"Limitations (",s.details.final_report.limitations.length,")"]}),x.jsx("div",{className:"space-y-1",children:s.details.final_report.limitations.map((e,s)=>x.jsxs("div",{className:"text-sm text-gray-800 bg-white rounded-lg p-2 border border-amber-100 flex items-start",children:[x.jsx("div",{className:"w-1.5 h-1.5 bg-amber-500 rounded-full mr-2 mt-1.5 flex-shrink-0"}),x.jsx("div",{children:e})]},s))})]})]}),x.jsxs("div",{className:"flex items-center gap-2 pt-3 border-t border-gray-200",children:[x.jsxs("button",{onClick:()=>{const e=`${s.details.final_report.executive_summary}\n\nDetailed Findings:\n${(s.details.final_report.detailed_findings||[]).map((e,s)=>`${s+1}. ${e.question}\n${e.answer}\n`).join("\n")}\n\nRecommendations:\n${(s.details.final_report.recommendations||[]).map((e,s)=>`${s+1}. ${e}`).join("\n")}`;navigator.clipboard.writeText(e)},className:"text-xs text-gray-600 hover:text-gray-800 flex items-center gap-1",children:[x.jsx("i",{className:"fas fa-copy"}),x.jsx("span",{children:"Copy Full Report"})]}),x.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(s.details.final_report.executive_summary)},className:"text-xs text-gray-600 hover:text-gray-800 flex items-center gap-1",children:[x.jsx("i",{className:"fas fa-scroll"}),x.jsx("span",{children:"Copy Executive Summary"})]})]})]}):x.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[x.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-emerald-600 mx-auto mb-2"}),x.jsx("div",{className:"text-sm text-gray-600",children:"Assembling final research report..."}),x.jsx("div",{className:"text-xs text-gray-500",children:"Synthesizing all research findings into comprehensive report"})]})]})]}):x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 text-xs",children:[s.details.current_operation&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Current Operation"}),x.jsx("div",{className:"text-gray-800",children:s.details.current_operation})]}),s.details.agent&&"Unknown"!==s.details.agent&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Agent"}),x.jsxs("div",{className:"text-gray-800 flex items-center",children:[x.jsx("i",{className:"fas fa-robot mr-1 text-blue-500"}),s.details.agent.replace("Agent","")]})]}),s.details.timestamp&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Last Updated"}),x.jsx("div",{className:"text-gray-800",children:new Date(s.details.timestamp).toLocaleTimeString()})]})]}),(s.details.tokens_used>0||s.details.api_calls>0||s.details.duration>0||s.details.cost_so_far>0)&&x.jsxs("div",{className:"border-t pt-3",children:[x.jsx("div",{className:"font-medium text-gray-600 mb-2 text-xs",children:"Performance Metrics"}),x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[s.details.tokens_used>0&&x.jsxs("div",{className:"bg-green-50 p-2 rounded border border-green-100",children:[x.jsx("div",{className:"text-xs font-medium text-green-700",children:s.details.tokens_used.toLocaleString()}),x.jsx("div",{className:"text-xs text-green-600",children:"Tokens"})]}),s.details.api_calls>0&&x.jsxs("div",{className:"bg-purple-50 p-2 rounded border border-purple-100",children:[x.jsx("div",{className:"text-xs font-medium text-purple-700",children:s.details.api_calls}),x.jsx("div",{className:"text-xs text-purple-600",children:"API Calls"})]}),s.details.duration>0&&x.jsxs("div",{className:"bg-blue-50 p-2 rounded border border-blue-100",children:[x.jsxs("div",{className:"text-xs font-medium text-blue-700",children:[s.details.duration.toFixed(1),"s"]}),x.jsx("div",{className:"text-xs text-blue-600",children:"Duration"})]}),s.details.cost_so_far>0&&x.jsxs("div",{className:"bg-yellow-50 p-2 rounded border border-yellow-100",children:[x.jsxs("div",{className:"text-xs font-medium text-yellow-700",children:["$",s.details.cost_so_far.toFixed(4)]}),x.jsx("div",{className:"text-xs text-yellow-600",children:"Cost"})]})]})]}),(s.details.model_used||s.details.sources_found>0)&&x.jsxs("div",{className:"border-t pt-3",children:[x.jsx("div",{className:"font-medium text-gray-600 mb-2 text-xs",children:"Additional Details"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-xs",children:[s.details.model_used&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Model Used"}),x.jsx("div",{className:"text-gray-800 font-mono text-xs bg-gray-100 px-2 py-1 rounded",children:s.details.model_used.replace("accounts/fireworks/models/","")})]}),s.details.sources_found>0&&x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-600 mb-1",children:"Sources Found"}),x.jsxs("div",{className:"text-gray-800 flex items-center",children:[x.jsx("i",{className:"fas fa-link mr-1 text-gray-500"}),s.details.sources_found," sources"]})]})]})]})]})})]})},Y=({filteringData:s})=>{var t,a,r;const[l,i]=e.useState("accepted"),[d,n]=e.useState(!1);if(!s)return x.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[x.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-emerald-600 mx-auto mb-2"}),x.jsx("div",{className:"text-sm text-gray-600",children:"Discovering and analyzing web sources..."}),x.jsx("div",{className:"text-xs text-gray-500",children:"Searching for relevant information across the web"})]});const{accepted_sources:c=[],rejected_sources:o=[],filtering_summary:m={}}=s;return x.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[x.jsxs("div",{className:"bg-gradient-to-r from-emerald-50 to-blue-50 p-4 border-b border-gray-200",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{children:[x.jsxs("h3",{className:"text-sm font-semibold text-gray-800 flex items-center",children:[x.jsx("i",{className:"fas fa-filter mr-2 text-emerald-600"}),"Source Discovery & Quality Filtering"]}),x.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["AI-powered filtering applied: ",x.jsx("span",{className:"font-medium",children:m.strategy||"Smart"})," strategy"]})]}),x.jsxs("button",{onClick:()=>n(!d),className:"text-xs text-gray-500 hover:text-gray-700 flex items-center gap-1 transition-colors",children:[x.jsx("i",{className:"fas fa-chevron-"+(d?"up":"down")}),"Details"]})]}),x.jsxs("div",{className:"grid grid-cols-4 gap-3 mt-3",children:[x.jsxs("div",{className:"bg-white rounded-lg p-3 text-center",children:[x.jsx("div",{className:"text-lg font-bold text-gray-700",children:m.original_count||0}),x.jsx("div",{className:"text-xs text-gray-500",children:"Found"})]}),x.jsxs("div",{className:"bg-white rounded-lg p-3 text-center",children:[x.jsx("div",{className:"text-lg font-bold text-emerald-600",children:c.length}),x.jsx("div",{className:"text-xs text-emerald-700",children:"Accepted"})]}),x.jsxs("div",{className:"bg-white rounded-lg p-3 text-center",children:[x.jsx("div",{className:"text-lg font-bold text-red-500",children:o.length}),x.jsx("div",{className:"text-xs text-red-600",children:"Filtered Out"})]}),x.jsxs("div",{className:"bg-white rounded-lg p-3 text-center",children:[x.jsx("div",{className:"text-lg font-bold text-blue-600",children:m.original_count>0?Math.round(o.length/m.original_count*100)+"%":"0%"}),x.jsx("div",{className:"text-xs text-blue-700",children:"Filter Rate"})]})]}),d&&x.jsxs("div",{className:"mt-4 p-3 bg-white rounded-lg border border-gray-100",children:[x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-xs",children:[x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-700 mb-2",children:"Filtering Strategy"}),x.jsxs("div",{className:"space-y-1",children:[x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{children:"Strategy:"}),x.jsx("span",{className:"font-medium capitalize",children:m.strategy||"Smart"})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{children:"Topic Type:"}),x.jsx("span",{className:"font-medium capitalize",children:m.topic_classification||"General"})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{children:"Confidence Boost:"}),x.jsxs("span",{className:"font-medium text-emerald-600",children:["+",(100*(m.confidence_boost||0)).toFixed(1),"%"]})]})]})]}),x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-700 mb-2",children:"Quality Thresholds"}),x.jsxs("div",{className:"space-y-1",children:[x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{children:"Authority:"}),x.jsxs("span",{className:"font-medium",children:[(100*((null==(t=m.thresholds)?void 0:t.authority)||.3)).toFixed(0),"%"]})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{children:"Relevance:"}),x.jsxs("span",{className:"font-medium",children:[(100*((null==(a=m.thresholds)?void 0:a.relevance)||.3)).toFixed(0),"%"]})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{children:"Content Quality:"}),x.jsxs("span",{className:"font-medium",children:[(100*((null==(r=m.thresholds)?void 0:r.content_quality)||.2)).toFixed(0),"%"]})]})]})]}),x.jsxs("div",{children:[x.jsx("div",{className:"font-medium text-gray-700 mb-2",children:"Quality Analysis"}),x.jsx("div",{className:"space-y-1",children:m.quality_distribution?x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{children:"Avg Authority:"}),x.jsxs("span",{className:"font-medium",children:[(100*(m.quality_distribution.mean_authority||.5)).toFixed(0),"%"]})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{children:"Avg Relevance:"}),x.jsxs("span",{className:"font-medium",children:[(100*(m.quality_distribution.mean_relevance||.5)).toFixed(0),"%"]})]}),x.jsxs("div",{className:"flex justify-between",children:[x.jsx("span",{children:"Avg Quality:"}),x.jsxs("span",{className:"font-medium",children:[(100*(m.quality_distribution.mean_quality||.5)).toFixed(0),"%"]})]})]}):x.jsx("div",{className:"text-gray-500 text-xs italic",children:"Computing quality metrics..."})})]})]}),m.reasoning&&m.reasoning.length>0&&x.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[x.jsx("div",{className:"font-medium text-gray-700 mb-2 text-xs",children:"Filtering Reasoning:"}),x.jsx("div",{className:"space-y-1",children:m.reasoning.slice(0,3).map((e,s)=>x.jsxs("div",{className:"text-xs text-gray-600 flex items-start",children:[x.jsx("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mr-2 mt-1.5 flex-shrink-0"}),x.jsx("div",{children:e})]},s))})]})]})]}),x.jsxs("div",{className:"flex border-b border-gray-200 bg-gray-50",children:[x.jsx("button",{onClick:()=>i("accepted"),className:"flex-1 px-4 py-3 text-sm font-medium transition-colors "+("accepted"===l?"bg-white text-emerald-700 border-b-2 border-emerald-500":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"),children:x.jsxs("div",{className:"flex items-center justify-center gap-2",children:[x.jsx("i",{className:"fas fa-check-circle text-emerald-500"}),x.jsx("span",{children:"Accepted Sources"}),x.jsx("span",{className:"bg-emerald-100 text-emerald-700 px-2 py-1 rounded-full text-xs font-bold",children:c.length})]})}),x.jsx("button",{onClick:()=>i("rejected"),className:"flex-1 px-4 py-3 text-sm font-medium transition-colors "+("rejected"===l?"bg-white text-red-700 border-b-2 border-red-500":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"),children:x.jsxs("div",{className:"flex items-center justify-center gap-2",children:[x.jsx("i",{className:"fas fa-times-circle text-red-500"}),x.jsx("span",{children:"Filtered Out"}),x.jsx("span",{className:"bg-red-100 text-red-700 px-2 py-1 rounded-full text-xs font-bold",children:o.length})]})})]}),x.jsxs("div",{className:"p-4",children:["accepted"===l&&x.jsx("div",{className:"space-y-3",children:c.length>0?x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"text-sm text-emerald-700 font-medium mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-check-circle mr-2"}),"High-quality sources selected for analysis"]}),x.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto scrollbar-thin",children:c.map((e,s)=>x.jsx("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg",children:x.jsx(W,{source:e,index:s})},s))})]}):x.jsxs("div",{className:"text-center py-8 text-gray-500",children:[x.jsx("i",{className:"fas fa-search text-3xl mb-3 text-gray-300"}),x.jsx("div",{className:"text-sm",children:"No accepted sources yet"}),x.jsx("div",{className:"text-xs",children:"Waiting for source discovery to complete..."})]})}),"rejected"===l&&x.jsx("div",{className:"space-y-3",children:o.length>0?x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"text-sm text-red-700 font-medium mb-3 flex items-center",children:[x.jsx("i",{className:"fas fa-times-circle mr-2"}),"Sources filtered out due to quality concerns"]}),x.jsxs("div",{className:"bg-red-50 rounded-lg p-3 border border-red-200 mb-3",children:[x.jsxs("div",{className:"text-xs font-medium text-red-700 mb-2 flex items-center",children:[x.jsx("i",{className:"fas fa-chart-bar mr-1"}),"Quality Comparison: Rejected vs. Accepted Sources"]}),x.jsxs("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[x.jsxs("div",{className:"text-center",children:[x.jsx("div",{className:"font-medium text-red-600",children:o.length>0?Math.round(o.reduce((e,s)=>e+(parseFloat(s.authority_score)||.5),0)/o.length*100)+"%":"N/A"}),x.jsx("div",{className:"text-gray-600",children:"Rejected Authority"})]}),x.jsxs("div",{className:"text-center",children:[x.jsx("div",{className:"font-medium text-red-600",children:o.length>0?Math.round(o.reduce((e,s)=>e+(parseFloat(s.relevance_score)||.5),0)/o.length*100)+"%":"N/A"}),x.jsx("div",{className:"text-gray-600",children:"Rejected Relevance"})]}),x.jsxs("div",{className:"text-center",children:[x.jsx("div",{className:"font-medium text-red-600",children:o.length>0?Math.round(o.reduce((e,s)=>e+(parseFloat(s.content_quality)||.5),0)/o.length*100)+"%":"N/A"}),x.jsx("div",{className:"text-gray-600",children:"Rejected Quality"})]})]}),c.length>0&&x.jsx("div",{className:"mt-2 pt-2 border-t border-red-200",children:x.jsxs("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[x.jsxs("div",{className:"text-center",children:[x.jsxs("div",{className:"font-medium text-emerald-600",children:[Math.round(c.reduce((e,s)=>e+(s.authority_score||.5),0)/c.length*100),"%"]}),x.jsx("div",{className:"text-gray-600",children:"Accepted Authority"})]}),x.jsxs("div",{className:"text-center",children:[x.jsxs("div",{className:"font-medium text-emerald-600",children:[Math.round(c.reduce((e,s)=>e+(s.relevance_score||.5),0)/c.length*100),"%"]}),x.jsx("div",{className:"text-gray-600",children:"Accepted Relevance"})]}),x.jsxs("div",{className:"text-center",children:[x.jsxs("div",{className:"font-medium text-emerald-600",children:[Math.round(c.reduce((e,s)=>e+(s.content_quality||.5),0)/c.length*100),"%"]}),x.jsx("div",{className:"text-gray-600",children:"Accepted Quality"})]})]})})]}),x.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto scrollbar-thin",children:o.map((e,s)=>x.jsx(V,{source:e,index:s},s))})]}):x.jsxs("div",{className:"text-center py-8 text-gray-500",children:[x.jsx("i",{className:"fas fa-shield-alt text-3xl mb-3 text-gray-300"}),x.jsx("div",{className:"text-sm",children:"No sources filtered out"}),x.jsx("div",{className:"text-xs",children:"All discovered sources met quality standards"})]})})]})]})},V=({source:s,index:t})=>{const[a,r]=e.useState(!1),l=e=>e>=.7?"text-green-600 bg-green-100":e>=.5?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100",i=e=>e.includes("authority")?"fas fa-shield-alt":e.includes("relevance")?"fas fa-bullseye":e.includes("quality")?"fas fa-star":"fas fa-exclamation-triangle";return x.jsxs("div",{className:"bg-white rounded-lg border border-red-200 shadow-sm",children:[x.jsxs("div",{className:"flex items-start justify-between p-3 cursor-pointer hover:bg-red-50 transition-colors",onClick:()=>r(!a),children:[x.jsxs("div",{className:"flex-1 min-w-0",children:[x.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[x.jsx("div",{className:"flex items-center justify-center w-6 h-6 bg-red-100 text-red-600 rounded-full text-xs font-bold",children:t+1}),x.jsx("div",{className:"text-sm font-medium text-gray-800 truncate",children:s.title||(e=>{try{return new URL(e).hostname.replace("www.","")}catch{return e}})(s.url)}),x.jsx("i",{className:"fas fa-times-circle text-red-500 text-xs"})]}),x.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-2",children:[x.jsx("i",{className:"fas fa-link text-red-400"}),x.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 hover:underline truncate max-w-md",onClick:e=>e.stopPropagation(),children:s.url})]}),x.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[void 0!==s.authority_score&&x.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${l(s.authority_score)}`,children:["Authority: ",Math.round(100*s.authority_score),"%"]}),void 0!==s.relevance_score&&x.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${l(s.relevance_score)}`,children:["Relevance: ",Math.round(100*s.relevance_score),"%"]}),void 0!==s.content_quality&&x.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${l(s.content_quality)}`,children:["Quality: ",Math.round(100*s.content_quality),"%"]})]}),s.rejection_reasons&&s.rejection_reasons.length>0&&x.jsx("div",{className:"flex flex-wrap gap-1",children:s.rejection_reasons.map((e,s)=>x.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-700 rounded-full text-xs font-medium",children:[x.jsx("i",{className:`${i(e)} text-xs`}),x.jsx("span",{className:"capitalize",children:e.replace("_"," ")})]},s))})]}),x.jsx("div",{className:"flex-shrink-0 ml-2",children:x.jsx("i",{className:`fas fa-chevron-${a?"up":"down"} text-xs text-gray-400 transition-transform`})})]}),a&&x.jsx("div",{className:"border-t bg-red-50 p-3",children:x.jsxs("div",{className:"space-y-3",children:[x.jsxs("div",{children:[x.jsx("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Quality Score Breakdown:"}),x.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[x.jsxs("div",{className:"bg-white rounded p-2 border border-red-200",children:[x.jsx("div",{className:"text-xs text-gray-600",children:"Authority"}),x.jsxs("div",{className:"text-sm font-bold "+(s.authority_score>=.5?"text-green-600":"text-red-600"),children:[s.authority_score?Math.round(100*s.authority_score):"N/A","%"]})]}),x.jsxs("div",{className:"bg-white rounded p-2 border border-red-200",children:[x.jsx("div",{className:"text-xs text-gray-600",children:"Relevance"}),x.jsxs("div",{className:"text-sm font-bold "+(s.relevance_score>=.5?"text-green-600":"text-red-600"),children:[s.relevance_score?Math.round(100*s.relevance_score):"N/A","%"]})]}),x.jsxs("div",{className:"bg-white rounded p-2 border border-red-200",children:[x.jsx("div",{className:"text-xs text-gray-600",children:"Content"}),x.jsxs("div",{className:"text-sm font-bold "+(s.content_quality>=.5?"text-green-600":"text-red-600"),children:[s.content_quality?Math.round(100*s.content_quality):"N/A","%"]})]})]})]}),s.rejection_explanation&&x.jsxs("div",{children:[x.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"Why was this filtered out?"}),x.jsx("div",{className:"text-xs text-gray-700 bg-white rounded p-3 border border-red-200",children:s.rejection_explanation})]}),(s.content||s.snippet)&&x.jsxs("div",{children:[x.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"Content Preview:"}),x.jsx("div",{className:"text-xs text-gray-600 bg-white rounded p-3 border border-red-200 max-h-32 overflow-y-auto",children:s.content||s.snippet})]})]})})]})};function X(){var s;const{state:t,actions:a,isResearching:r,isCompleted:l,isFailed:i,getRealTimeDuration:d}=(()=>{const s=e.useContext(G);if(!s)throw new Error("useResearchContext must be used within a ResearchProvider");return s})(),[n,c]=e.useState(null);(()=>{const s=e.useRef(null),[t,a]=e.useState(null),[r,l]=e.useState(!1);e.useCallback((e,t)=>{s.current&&s.current.close();const r={onMessage:e=>{var s;a(e),null==(s=null==t?void 0:t.onMessage)||s.call(t,e)},onOpen:()=>{var e;l(!0),null==(e=null==t?void 0:t.onOpen)||e.call(t)},onClose:()=>{var e;l(!1),null==(e=null==t?void 0:t.onClose)||e.call(t)},onError:e=>{var s;l(!1),null==(s=null==t?void 0:t.onError)||s.call(t,e)}};return s.current=w(e,r),s.current},[]),e.useCallback(()=>{s.current&&(s.current.close(),s.current=null),l(!1),a(null)},[])})();const{error:o}=(()=>{const[s,t]=e.useState(!1),[a,r]=e.useState(null),[l,i]=e.useState(null),[d,n]=e.useState(null),[c,o]=e.useState(null),[m,x]=e.useState(null),u=e.useCallback(async(e,s)=>{if(e.query.trim()){window.currentQuery=e.query.trim(),t(!0),o(null),i(null),r(null);try{const a=await _.startResearch(e);a.session_id?(n(a.session_id),null==s||s(a.session_id)):(o(a.message),t(!1))}catch(a){o("Failed to start research: "+a.message),t(!1)}}},[]),g=e.useCallback(async e=>{try{const t=await _.getResults(e);i(t);try{const s=await _.getMetrics(e);s.success&&s.metrics&&"No detailed metrics available for this session"!==s.metrics.message&&x(s.metrics)}catch(s){console.warn("Failed to fetch metrics:",s.message)}}catch(s){o("Failed to fetch results: "+s.message)}},[]);return{isResearching:s,setIsResearching:t,progress:a,setProgress:r,results:l,setResults:i,currentSession:d,setCurrentSession:n,error:c,setError:o,metrics:m,setMetrics:x,startResearch:u,fetchResults:g}})(),{modelConfig:m,agentModels:u,availableModels:g,apiKeys:h,updateAgentModel:p,saveModelConfig:b,setApiKeys:f,applyModelPreset:C}=k(),S=a.toggleArchitecture,A=a.toggleApiConfig,R=a.toggleModelConfig,M=a.clearError,q=e.useCallback(async()=>{try{await a.startResearch(m,u)}catch(e){console.error("Failed to start research:",e)}},[a,m,u]);return e.useEffect(()=>{o&&a.setError(o)},[o,a]),e.useEffect(()=>{(async()=>{try{const e=await fetch("/api/config");if(e.ok){const s=await e.json();c(s)}}catch(e){console.error("Failed to fetch API config:",e)}})()},[]),x.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[x.jsx("header",{className:"bg-white shadow-sm border-b",children:x.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center space-x-3",children:[x.jsx("i",{className:"fas fa-search-plus text-2xl text-indigo-600"}),x.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Multi-Agent Research System"})]}),x.jsxs("div",{className:"flex items-center space-x-4",children:[x.jsxs("button",{onClick:A,className:"flex items-center space-x-2 px-3 py-2 text-sm text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-md transition-colors",children:[x.jsx("i",{className:"fas fa-key"}),x.jsx("span",{children:"API Keys"})]}),x.jsxs("button",{onClick:R,className:"flex items-center space-x-2 px-3 py-2 text-sm text-purple-600 hover:text-purple-800 hover:bg-purple-50 rounded-md transition-colors",children:[x.jsx("i",{className:"fas fa-cogs"}),x.jsx("span",{children:"Agent Models"})]}),x.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[x.jsx("i",{className:"fas fa-rocket"}),x.jsx("span",{children:"Intelligent Parallel Processing"})]}),x.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[x.jsx("i",{className:"fas fa-search"}),x.jsxs("span",{className:"text-gray-700",children:["Search: ",x.jsx("span",{className:"font-medium text-blue-600",children:(()=>{const e=null==n?void 0:n.search_engine;if(!e)return"Loading...";const s=e.preferred||"brave",t=e.firecrawl_available,a=e.brave_available;return"firecrawl"===s&&t?"üî• Firecrawl (Full Content)":"brave"===s&&a?"üîç Brave Search":"auto"===s?t?"üî• Auto (Firecrawl Preferred)":"üîç Auto (Brave Fallback)":"‚ö†Ô∏è No Search Engine"})()})]})]})]})]})})}),x.jsx(v,{show:t.showApiConfig,onClose:A,apiKeys:h,setApiKeys:f}),x.jsx(N,{show:t.showModelConfig,onClose:R,modelConfig:m,agentModels:u,availableModels:g,updateAgentModel:p,saveModelConfig:b,applyModelPreset:C}),x.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:x.jsxs("div",{className:"flex gap-6",children:[x.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[x.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[x.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:[x.jsx("i",{className:"fas fa-lightbulb text-yellow-500 mr-2"}),"Start Your Research"]}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Research Query"}),x.jsx("textarea",{value:t.query,onChange:e=>a.setQuery(e.target.value),placeholder:"What would you like to research? (e.g., 'Latest developments in artificial intelligence and their impact on healthcare')",className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 transition-colors "+(t.query.trim().length<3&&t.query.trim().length>0||t.query.trim().length>1e3?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-indigo-500 focus:border-transparent"),rows:"3",disabled:r}),x.jsxs("div",{className:"flex justify-between items-center mt-1",children:[x.jsx("div",{className:"text-xs text-gray-500",children:"Minimum 3 characters required"}),x.jsxs("div",{className:"text-xs "+(t.query.length>1e3?"text-red-500":t.query.length>900?"text-yellow-500":"text-gray-500"),children:[t.query.length,"/1000 characters"]})]})]}),x.jsxs("div",{className:"space-y-4",children:[x.jsx("div",{className:"flex items-start space-x-4",children:x.jsxs("div",{className:"flex-shrink-0",children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Sub-Questions"}),x.jsxs("select",{value:t.maxQuestions,onChange:e=>a.setMaxQuestions(parseInt(e.target.value)),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 h-10",disabled:r,children:[x.jsx("option",{value:3,children:"3 (Quick)"}),x.jsx("option",{value:5,children:"5 (Balanced)"}),x.jsx("option",{value:7,children:"7 (Comprehensive)"}),x.jsx("option",{value:10,children:"10 (Deep Dive)"})]})]})}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Model Presets"}),x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mb-4",children:[x.jsxs("button",{onClick:()=>{console.log("üñ±Ô∏è Budget preset button clicked"),C("budget")},disabled:r,className:"px-3 py-2 text-xs bg-green-50 border border-green-200 text-green-700 rounded-md hover:bg-green-100 disabled:opacity-50 transition-colors",title:"Cost-effective models optimized for each agent task",children:[x.jsx("i",{className:"fas fa-piggy-bank mr-1"}),"Budget"]}),x.jsxs("button",{onClick:()=>C("balanced"),disabled:r,className:"px-3 py-2 text-xs bg-blue-50 border border-blue-200 text-blue-700 rounded-md hover:bg-blue-100 disabled:opacity-50 transition-colors",title:"Good balance of cost and performance with task specialization",children:[x.jsx("i",{className:"fas fa-balance-scale mr-1"}),"Balanced"]}),x.jsxs("button",{onClick:()=>C("performance"),disabled:r,className:"px-3 py-2 text-xs bg-purple-50 border border-purple-200 text-purple-700 rounded-md hover:bg-purple-100 disabled:opacity-50 transition-colors",title:"High-quality models specialized for each agent's role",children:[x.jsx("i",{className:"fas fa-rocket mr-1"}),"Performance"]}),x.jsxs("button",{onClick:()=>C("premium"),disabled:r,className:"px-3 py-2 text-xs bg-red-50 border border-red-200 text-red-700 rounded-md hover:bg-red-100 disabled:opacity-50 transition-colors",title:"Best available models for maximum quality results",children:[x.jsx("i",{className:"fas fa-crown mr-1"}),"Premium"]})]}),x.jsx("div",{className:"text-xs text-gray-500 mb-4",children:"Choose a preset to automatically configure optimal models for each agent based on their specific tasks. Hover for details."})]}),x.jsxs("div",{children:[x.jsxs("div",{className:"flex items-center justify-between mb-2",children:[x.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Agent Model Configuration"}),x.jsxs("button",{onClick:R,className:"text-xs text-purple-600 hover:text-purple-800 flex items-center",children:[x.jsx("i",{className:"fas fa-cogs mr-1"}),"Advanced Settings"]})]}),m&&m.agent_assignments?x.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-3",children:m.agent_assignments.map((e,s)=>x.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:[x.jsxs("div",{className:"mb-2",children:[x.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e.agent_type.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())," Agent"]}),x.jsx("select",{value:u[e.agent_type]||e.model_name,onChange:s=>p(e.agent_type,s.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500 text-xs",disabled:r,children:m.available_models.map(e=>x.jsx("option",{value:e,children:e.replace("accounts/fireworks/models/","")},e))})]}),(()=>{const s=u[e.agent_type]||e.model_name,t=m.model_pricing[s];return t?x.jsxs("div",{className:"text-xs text-gray-500",children:["$",t.input,"/$",t.output," per 1M"]}):null})()]},e.agent_type))}):x.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[x.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-indigo-600 mx-auto mb-2"}),x.jsx("div",{className:"text-xs text-gray-600",children:"Loading agent configurations..."})]}),x.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Each agent uses a specialized AI model optimized for its task. Changes apply to the current research session."})]})]}),x.jsx("div",{className:"mt-4",children:x.jsx("button",{onClick:q,disabled:r||!t.query||!t.query.trim(),className:"w-full bg-indigo-600 text-white px-6 py-3 rounded-md hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-lg font-medium",children:r?x.jsxs(x.Fragment,{children:[x.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Researching..."]}):x.jsxs(x.Fragment,{children:[x.jsx("i",{className:"fas fa-search mr-2"}),"Start Research"]})})})]}),t.error&&x.jsx("div",{className:"mt-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative",children:x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{children:t.error}),x.jsx("button",{onClick:M,className:"text-red-500 hover:text-red-700",children:x.jsx("i",{className:"fas fa-times"})})]})})]}),(r||t.progress)&&x.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[x.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:[x.jsx("i",{className:"fas fa-cogs text-blue-500 mr-2"}),"Research Pipeline"]}),x.jsx(j,{progress:t.progress})]}),t.progress&&x.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6 mb-6 shadow-sm",children:[x.jsxs("h3",{className:"text-lg font-semibold text-blue-900 mb-4",children:[x.jsx("i",{className:"fas fa-cogs text-blue-600 mr-2"}),"Research Progress"]}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsx("span",{className:"text-sm font-medium text-blue-700",children:t.progress.stage||"Processing..."}),x.jsxs("span",{className:"text-sm text-blue-600 font-semibold",children:[t.progress.progress_percentage||0,"%"]})]}),x.jsx("div",{className:"w-full bg-blue-200 rounded-full h-3 shadow-inner",children:x.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full transition-all duration-700 shadow-sm",style:{width:`${t.progress.progress_percentage||0}%`}})}),t.progress.current_operation&&x.jsxs("div",{className:"flex items-center text-sm text-blue-700 bg-white p-2 rounded border border-blue-100",children:[x.jsx("i",{className:"fas fa-arrow-right mr-2 text-blue-500"}),x.jsx("span",{className:"font-medium",children:t.progress.current_operation})]}),(t.progress.tokens_used||t.progress.estimated_cost||t.progress.api_calls_made)&&x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:[x.jsxs("div",{className:"bg-white p-3 rounded-lg border border-green-100 text-center",children:[x.jsx("div",{className:"text-lg font-bold text-green-600",children:t.progress.tokens_used||0}),x.jsx("div",{className:"text-xs text-green-700 font-medium",children:"Tokens Used"})]}),x.jsxs("div",{className:"bg-white p-3 rounded-lg border border-purple-100 text-center",children:[x.jsx("div",{className:"text-lg font-bold text-purple-600",children:"number"==typeof t.progress.estimated_cost?`$${t.progress.estimated_cost.toFixed(4)}`:"string"==typeof t.progress.estimated_cost?t.progress.estimated_cost:"$0.0000"}),x.jsx("div",{className:"text-xs text-purple-700 font-medium",children:"Estimated Cost"})]}),x.jsxs("div",{className:"bg-white p-3 rounded-lg border border-orange-100 text-center",children:[x.jsx("div",{className:"text-lg font-bold text-orange-600",children:t.progress.api_calls_made||0}),x.jsx("div",{className:"text-xs text-orange-700 font-medium",children:"API Calls"})]}),x.jsxs("div",{className:"bg-white p-3 rounded-lg border border-blue-100 text-center",children:[x.jsx("div",{className:"text-lg font-bold text-blue-600",children:d()}),x.jsx("div",{className:"text-xs text-blue-700 font-medium",children:"Duration"})]})]}),"completed"===t.progress.status&&x.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-green-200 mt-4",children:x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsx("i",{className:"fas fa-check-circle text-green-500"}),x.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Research completed successfully with ",(null==(s=t.progress.final_metrics)?void 0:s.steps_completed)||t.progress.steps_completed||0," steps"]})]})}),t.progress.stage_breakdown&&x.jsxs("div",{className:"mt-4",children:[x.jsx("div",{className:"text-xs font-semibold text-blue-700 mb-3",children:"Research Pipeline Stages"}),x.jsx("div",{className:"space-y-2",children:t.progress.stage_breakdown.map((e,s)=>x.jsx(J,{stage:e,stageIndex:s,progress:t.progress},s))})]}),t.progress.parallel_operations&&t.progress.parallel_operations.length>0&&x.jsxs("div",{className:"mt-4",children:[x.jsxs("div",{className:"text-xs font-semibold text-blue-700 mb-2",children:[x.jsx("i",{className:"fas fa-layer-group mr-1"}),"Parallel Operations (",t.progress.parallel_operations.length,")"]}),x.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:t.progress.parallel_operations.map((e,s)=>x.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-100 shadow-sm",children:[x.jsxs("div",{className:"flex items-center justify-between mb-1",children:[x.jsx("div",{className:"text-xs font-medium text-gray-700",children:e.agent}),x.jsx("div",{className:"w-2 h-2 rounded-full "+("completed"===e.status?"bg-green-500":"processing"===e.status?"bg-blue-500 animate-pulse":"bg-yellow-500")})]}),x.jsx("div",{className:"text-xs text-gray-600",children:e.status}),e.tokens_used&&x.jsxs("div",{className:"text-xs text-green-600 mt-1",children:[e.tokens_used," tokens"]})]},s))})]})]})]}),t.results&&x.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 max-w-full overflow-hidden",children:[x.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:[x.jsx("i",{className:"fas fa-analytics text-purple-500 mr-2"}),"Performance Analytics"]}),x.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:[x.jsx("i",{className:"fas fa-info-circle mr-1"}),"System performance metrics and export options. For research findings, see the ",x.jsx("strong",{children:"Report Assembly"})," section above."]}),t.results.confidence_score&&x.jsx("div",{className:"mb-6 flex items-center space-x-4",children:x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{className:"text-sm font-medium text-gray-700 mr-2",children:"Quality Score:"}),x.jsxs("div",{className:"flex items-center",children:[x.jsx("div",{className:"w-20 bg-gray-200 rounded-full h-2 mr-2",children:x.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:100*t.results.confidence_score+"%"}})}),x.jsxs("span",{className:"text-sm font-semibold",children:[(100*t.results.confidence_score).toFixed(1),"%"]})]})]})}),x.jsxs("div",{className:"mb-6 flex space-x-3",children:[x.jsxs("button",{onClick:()=>window.open(`/api/research/${t.currentSession}/export/pdf`),className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors",children:[x.jsx("i",{className:"fas fa-file-pdf mr-2"}),"Export PDF"]}),x.jsxs("button",{onClick:()=>window.open(`/api/research/${t.currentSession}/export/html`),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:[x.jsx("i",{className:"fas fa-file-code mr-2"}),"Export HTML"]}),x.jsxs("button",{onClick:()=>{const e=JSON.stringify(t.results,null,2),s=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(s),r=document.createElement("a");r.href=a,r.download=`research_data_${t.currentSession}.json`,r.click()},className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors",title:"Download raw research data and metrics",children:[x.jsx("i",{className:"fas fa-download mr-2"}),"Download Raw Data"]})]}),t.metrics&&x.jsxs("div",{className:"mb-6 bg-gray-50 rounded-lg p-6 animate-fade-in",children:[x.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:[x.jsx("i",{className:"fas fa-analytics text-purple-600 mr-2"}),"Performance Metrics"]}),x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[x.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[x.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.metrics.total_duration}),x.jsx("div",{className:"text-sm text-gray-600",children:"Total Time"})]}),x.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[x.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.metrics.total_tokens}),x.jsx("div",{className:"text-sm text-gray-600",children:"Total Tokens"})]}),x.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[x.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.metrics.total_cost}),x.jsx("div",{className:"text-sm text-gray-600",children:"Total Cost"})]}),x.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[x.jsx("div",{className:"text-2xl font-bold text-orange-600",children:t.metrics.cache_hit_rate}),x.jsx("div",{className:"text-sm text-gray-600",children:"Cache Hit Rate"})]})]}),t.metrics.insights&&x.jsxs("div",{className:"mb-6",children:[x.jsx("h5",{className:"text-md font-semibold text-gray-800 mb-3",children:"Performance Insights"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[x.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[x.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Slowest Step"}),x.jsx("div",{className:"text-lg font-semibold text-red-600",children:t.metrics.insights.slowest_step.name}),x.jsxs("div",{className:"text-sm text-gray-600",children:[t.metrics.insights.slowest_step.duration," - ",t.metrics.insights.slowest_step.agent]})]}),x.jsxs("div",{className:"bg-white p-4 rounded-lg shadow",children:[x.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Most Expensive Step"}),x.jsx("div",{className:"text-lg font-semibold text-yellow-600",children:t.metrics.insights.most_expensive_step.name}),x.jsxs("div",{className:"text-sm text-gray-600",children:[t.metrics.insights.most_expensive_step.cost," - ",t.metrics.insights.most_expensive_step.agent]})]})]})]}),t.metrics.steps&&x.jsxs("div",{className:"mb-6 h-96 overflow-y-auto bg-gray-50 rounded-lg p-4 scrollbar-thin",children:[x.jsxs("h5",{className:"text-md font-semibold text-gray-800 mb-3",children:[x.jsx("i",{className:"fas fa-list-ol text-blue-600 mr-2"}),"Detailed Step Breakdown"]}),x.jsx("div",{className:"space-y-4",children:t.metrics.steps.map((e,s)=>x.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[x.jsxs("div",{className:"flex items-center justify-between mb-3",children:[x.jsxs("div",{className:"flex items-center space-x-3",children:[x.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-600 rounded-full text-sm font-semibold",children:s+1}),x.jsxs("div",{children:[x.jsx("h6",{className:"text-sm font-semibold text-gray-900",children:e.step_name}),x.jsx("p",{className:"text-xs text-gray-500",children:e.agent}),e.model_used&&x.jsxs("p",{className:"text-xs text-blue-600 font-medium",children:[x.jsx("i",{className:"fas fa-robot mr-1"}),e.model_used]})]})]}),x.jsxs("div",{className:"text-right",children:[x.jsx("div",{className:"text-sm font-semibold text-gray-900",children:e.duration}),x.jsxs("div",{className:"text-xs text-gray-500",children:[e.api_calls," API calls"]})]})]}),x.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-3",children:[x.jsxs("div",{className:"bg-green-50 p-2 rounded border border-green-100",children:[x.jsx("div",{className:"text-sm font-bold text-green-700",children:e.total_tokens}),x.jsx("div",{className:"text-xs text-green-600",children:"Total Tokens"})]}),x.jsxs("div",{className:"bg-blue-50 p-2 rounded border border-blue-100",children:[x.jsx("div",{className:"text-sm font-bold text-blue-700",children:e.prompt_tokens||"N/A"}),x.jsx("div",{className:"text-xs text-blue-600",children:"Prompt Tokens"})]}),x.jsxs("div",{className:"bg-purple-50 p-2 rounded border border-purple-100",children:[x.jsx("div",{className:"text-sm font-bold text-purple-700",children:e.completion_tokens||"N/A"}),x.jsx("div",{className:"text-xs text-purple-600",children:"Completion Tokens"})]}),x.jsxs("div",{className:"bg-yellow-50 p-2 rounded border border-yellow-100",children:[x.jsx("div",{className:"text-sm font-bold text-yellow-700",children:e.cost}),x.jsx("div",{className:"text-xs text-yellow-600",children:"Cost"})]})]}),e.prompt_tokens&&e.completion_tokens&&e.total_tokens&&x.jsxs("div",{className:"mb-3",children:[x.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[x.jsx("span",{children:"Token Distribution"}),x.jsxs("span",{children:[e.total_tokens," total"]})]}),x.jsxs("div",{className:"flex h-2 bg-gray-200 rounded-full overflow-hidden",children:[x.jsx("div",{className:"bg-blue-500",style:{width:`${(()=>{const s=parseInt(e.prompt_tokens)||0,t=s+(parseInt(e.completion_tokens)||0);return t>0?Math.max(0,Math.min(100,s/t*100)):0})()}%`},title:`Prompt: ${e.prompt_tokens} tokens`}),x.jsx("div",{className:"bg-purple-500",style:{width:`${(()=>{const s=parseInt(e.prompt_tokens)||0,t=parseInt(e.completion_tokens)||0,a=s+t;return a>0?Math.max(0,Math.min(100,t/a*100)):0})()}%`},title:`Completion: ${e.completion_tokens} tokens`})]}),x.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[x.jsxs("span",{children:["Prompt (",(()=>{const s=parseInt(e.prompt_tokens)||0,t=s+(parseInt(e.completion_tokens)||0);return t>0?(s/t*100).toFixed(1):"0"})(),"%)"]}),x.jsxs("span",{children:["Completion (",(()=>{const s=parseInt(e.prompt_tokens)||0,t=parseInt(e.completion_tokens)||0,a=s+t;return a>0?(t/a*100).toFixed(1):"0"})(),"%)"]})]})]}),x.jsx("div",{className:"flex items-center justify-between text-xs",children:x.jsxs("div",{className:"flex items-center space-x-3",children:[x.jsx("span",{className:"px-2 py-1 rounded-full "+(e.success?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:e.success?"Success":"Failed"}),e.cache_hits>0&&x.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full",children:[e.cache_hits," Cache Hits"]})]})})]},s))})]})]})]})]}),!t.showArchitecture&&x.jsx("div",{className:"fixed top-32 right-6 z-20",children:x.jsxs("button",{onClick:S,className:"bg-blue-600 hover:bg-blue-700 text-white shadow-lg rounded-lg px-4 py-2 text-sm font-medium transition-all duration-200 flex items-center space-x-2",title:"Show System Architecture",children:[x.jsx("i",{className:"fas fa-network-wired"}),x.jsx("span",{children:"Show Architecture"})]})}),x.jsx(y,{show:t.showArchitecture,onToggle:S,progress:t.progress})]})})]})}function Z(){return x.jsx(h,{children:x.jsx(X,{})})}u.createRoot(document.getElementById("root")).render(x.jsx(t.StrictMode,{children:x.jsx(K,{children:x.jsx(Z,{})})}));
